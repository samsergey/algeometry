<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">{-|
Module      : Algeometry.SVG
Description : Quick and dirty graphic backend for geometric algebra.
Stability   : experimental
-}</span></span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances
, LambdaCase
, DerivingVia
, StandaloneDeriving
, DataKinds
, KindSignatures
, GeneralizedNewtypeDeriving
, MultiParamTypeClasses
, FlexibleInstances
, OverloadedStrings
, FunctionalDependencies
, BangPatterns #-}</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algeometry.SVG</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier">Fig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier">Figure</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#figure"><span class="hs-identifier">figure</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#getFigure"><span class="hs-identifier">getFigure</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#getResult"><span class="hs-identifier">getResult</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#mapFig"><span class="hs-identifier">mapFig</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier">Animation</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- * SVG generation and output</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#put"><span class="hs-identifier">put</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#%40"><span class="hs-operator">(@)</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#%3C%40"><span class="hs-operator">(&lt;@)</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#svg"><span class="hs-identifier">svg</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#writeSVG"><span class="hs-identifier">writeSVG</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#writePNG"><span class="hs-identifier">writePNG</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Simple animation</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#writeFrame"><span class="hs-identifier">writeFrame</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#runAnimation"><span class="hs-identifier">runAnimation</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#animate"><span class="hs-identifier">animate</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#transform"><span class="hs-identifier">transform</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#animateList"><span class="hs-identifier">animateList</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Constructors</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#origin"><span class="hs-identifier">origin</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier">point</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#line"><span class="hs-identifier">line</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#nline"><span class="hs-identifier">nline</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#vect"><span class="hs-identifier">vect</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#nvect"><span class="hs-identifier">nvect</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#segm"><span class="hs-identifier">segm</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier">polygon</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#polyline"><span class="hs-identifier">polyline</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#regularPoly"><span class="hs-identifier">regularPoly</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#segment"><span class="hs-identifier">segment</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#plane"><span class="hs-identifier">plane</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#plane2"><span class="hs-identifier">plane2</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#plane3"><span class="hs-identifier">plane3</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#orthoPlane"><span class="hs-identifier">orthoPlane</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#label"><span class="hs-keyword">label</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#display"><span class="hs-identifier">display</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Miscellaneous tools</span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#viewPoint"><span class="hs-identifier">viewPoint</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#axis"><span class="hs-identifier">axis</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#grid"><span class="hs-identifier">grid</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#background"><span class="hs-identifier">background</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algeometry.html"><span class="hs-identifier">Algeometry</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">union</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lucid.Base</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HtmlT</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lucid.Svg</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">scale</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Term</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Process</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">With</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679268689"><span class="annot"><span class="annottext">with :: [Attribute] -&gt; [Attribute] -&gt; [Attribute]
</span><a href="#local-6989586621679268689"><span class="hs-identifier hs-var hs-var hs-var hs-var">with</span></a></span></span><span> </span><span id="local-6989586621679268691"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268691"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679268692"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268692"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Attribute] -&gt; Attribute -&gt; [Attribute])
-&gt; [Attribute] -&gt; [Attribute] -&gt; [Attribute]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; Attribute -&gt; [Attribute]
</span><a href="#local-6989586621679268694"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268691"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268692"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>      </span><span id="local-6989586621679268694"><span class="annot"><span class="annottext">add :: [Attribute] -&gt; Attribute -&gt; [Attribute]
</span><a href="#local-6989586621679268694"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621679268697"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268697"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621679268698"><span class="annot"><span class="annottext">att :: Attribute
</span><a href="#local-6989586621679268698"><span class="hs-identifier hs-var">att</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span> </span><span id="local-6989586621679268700"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679268700"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679268701"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679268701"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268697"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span> </span><span id="local-6989586621679268702"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679268702"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679268703"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268703"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679268700"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679268702"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679268698"><span class="hs-identifier hs-var">att</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; [Attribute] -&gt; [Attribute]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268703"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span id="local-6989586621679268704"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268704"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679268698"><span class="hs-identifier hs-var">att</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; [Attribute] -&gt; [Attribute]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268704"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-keyword">type</span><span> </span><span id="XY"><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-var">XY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="annot"><span class="hs-comment">-- | Represents graphic primitives</span></span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="Fig"><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-var">Fig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Point"><span class="annot"><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-var">Point</span></a></span></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-type">XY</span></a></span><span>
</span><span id="line-96"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span id="Line"><span class="annot"><a href="Algeometry.SVG.html#Line"><span class="hs-identifier hs-var">Line</span></a></span></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-type">XY</span></a></span><span> </span><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-type">XY</span></a></span><span>
</span><span id="line-97"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span id="Polygon"><span class="annot"><a href="Algeometry.SVG.html#Polygon"><span class="hs-identifier hs-var">Polygon</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-type">XY</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679268709"><span id="local-6989586621679268727"><span id="local-6989586621679268731"><span class="annot"><span class="annottext">Int -&gt; Fig -&gt; ShowS
[Fig] -&gt; ShowS
Fig -&gt; String
(Int -&gt; Fig -&gt; ShowS)
-&gt; (Fig -&gt; String) -&gt; ([Fig] -&gt; ShowS) -&gt; Show Fig
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Fig -&gt; ShowS
showsPrec :: Int -&gt; Fig -&gt; ShowS
$cshow :: Fig -&gt; String
show :: Fig -&gt; String
$cshowList :: [Fig] -&gt; ShowS
showList :: [Fig] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268737"><span id="local-6989586621679268751"><span class="annot"><span class="annottext">Fig -&gt; Fig -&gt; Bool
(Fig -&gt; Fig -&gt; Bool) -&gt; (Fig -&gt; Fig -&gt; Bool) -&gt; Eq Fig
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Fig -&gt; Fig -&gt; Bool
== :: Fig -&gt; Fig -&gt; Bool
$c/= :: Fig -&gt; Fig -&gt; Bool
/= :: Fig -&gt; Fig -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679268761"><span id="local-6989586621679268765"><span id="local-6989586621679268768"><span id="local-6989586621679268771"><span id="local-6989586621679268774"><span id="local-6989586621679268777"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-type">Fig</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621679268780"><span class="annot"><span class="annottext">compare :: Fig -&gt; Fig -&gt; Ordering
</span><a href="#local-6989586621679268780"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">XY
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Fig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">XY
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Fig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Fig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Algeometry.SVG.html#clip"><span class="hs-identifier hs-type">clip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span id="clip"><span class="annot"><span class="annottext">clip :: PGA2 -&gt; [PGA2]
</span><a href="Algeometry.SVG.html#clip"><span class="hs-identifier hs-var hs-var">clip</span></a></span></span><span> </span><span id="local-6989586621679268783"><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679268783"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679268813"><span class="annot"><span class="annottext">vs :: [PGA2]
</span><a href="#local-6989586621679268813"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; PGA2
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; PGA2) -&gt; [[Double]] -&gt; [PGA2]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679268817"><span class="annot"><span class="annottext">frame :: [(PGA2, PGA2)]
</span><a href="#local-6989586621679268817"><span class="hs-identifier hs-var hs-var">frame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PGA2] -&gt; [PGA2] -&gt; [(PGA2, PGA2)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679268813"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PGA2] -&gt; [PGA2]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679268813"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">((PGA2, PGA2) -&gt; Maybe PGA2) -&gt; [(PGA2, PGA2)] -&gt; [PGA2]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGA2 -&gt; (PGA2, PGA2) -&gt; Maybe PGA2
forall mv. GeomAlgebra mv =&gt; mv -&gt; (mv, mv) -&gt; Maybe mv
</span><a href="Algeometry.GeometricAlgebra.html#segmentMeet"><span class="hs-identifier hs-var">segmentMeet</span></a></span><span> </span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679268783"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(PGA2, PGA2)]
</span><a href="#local-6989586621679268817"><span class="hs-identifier hs-var">frame</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><span class="hs-comment">-- | Representation of a figure with many graphic objects with attributes.</span></span><span>
</span><span id="line-116"></span><span class="hs-keyword">newtype</span><span> </span><span id="Figure"><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span></span><span> </span><span id="local-6989586621679268420"><span class="annot"><a href="#local-6989586621679268420"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679268421"><span class="annot"><a href="#local-6989586621679268421"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Figure"><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679268420"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679268421"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679268825"><span id="local-6989586621679268830"><span id="local-6989586621679268834"><span class="annot"><span class="annottext">Int -&gt; Figure a b -&gt; ShowS
[Figure a b] -&gt; ShowS
Figure a b -&gt; String
(Int -&gt; Figure a b -&gt; ShowS)
-&gt; (Figure a b -&gt; String)
-&gt; ([Figure a b] -&gt; ShowS)
-&gt; Show (Figure a b)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall a b. (Show a, Show b) =&gt; Int -&gt; Figure a b -&gt; ShowS
forall a b. (Show a, Show b) =&gt; [Figure a b] -&gt; ShowS
forall a b. (Show a, Show b) =&gt; Figure a b -&gt; String
$cshowsPrec :: forall a b. (Show a, Show b) =&gt; Int -&gt; Figure a b -&gt; ShowS
showsPrec :: Int -&gt; Figure a b -&gt; ShowS
$cshow :: forall a b. (Show a, Show b) =&gt; Figure a b -&gt; String
show :: Figure a b -&gt; String
$cshowList :: forall a b. (Show a, Show b) =&gt; [Figure a b] -&gt; ShowS
showList :: [Figure a b] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268841"><span id="local-6989586621679268846"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Figure a a -&gt; Figure a b)
-&gt; (forall a b. a -&gt; Figure a b -&gt; Figure a a)
-&gt; Functor (Figure a)
forall a b. a -&gt; Figure a b -&gt; Figure a a
forall a b. (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
forall a a b. a -&gt; Figure a b -&gt; Figure a a
forall a a b. (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a a b. (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
fmap :: forall a b. (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
$c&lt;$ :: forall a a b. a -&gt; Figure a b -&gt; Figure a a
&lt;$ :: forall a b. a -&gt; Figure a b -&gt; Figure a a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268854"><span id="local-6989586621679268860"><span id="local-6989586621679268865"><span id="local-6989586621679268870"><span id="local-6989586621679268875"><span class="annot"><span class="annottext">Functor (Figure a)
Functor (Figure a)
-&gt; (forall a. a -&gt; Figure a a)
-&gt; (forall a b. Figure a (a -&gt; b) -&gt; Figure a a -&gt; Figure a b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; Figure a a -&gt; Figure a b -&gt; Figure a c)
-&gt; (forall a b. Figure a a -&gt; Figure a b -&gt; Figure a b)
-&gt; (forall a b. Figure a a -&gt; Figure a b -&gt; Figure a a)
-&gt; Applicative (Figure a)
forall a. Functor (Figure a)
forall a. a -&gt; Figure a a
forall a a. a -&gt; Figure a a
forall a b. Figure a a -&gt; Figure a b -&gt; Figure a a
forall a b. Figure a a -&gt; Figure a b -&gt; Figure a b
forall a b. Figure a (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a a
forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a b
forall a a b. Figure a (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
forall a b c.
(a -&gt; b -&gt; c) -&gt; Figure a a -&gt; Figure a b -&gt; Figure a c
forall a a b c.
(a -&gt; b -&gt; c) -&gt; Figure a a -&gt; Figure a b -&gt; Figure a c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall a a. a -&gt; Figure a a
pure :: forall a. a -&gt; Figure a a
$c&lt;*&gt; :: forall a a b. Figure a (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
&lt;*&gt; :: forall a b. Figure a (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
$cliftA2 :: forall a a b c.
(a -&gt; b -&gt; c) -&gt; Figure a a -&gt; Figure a b -&gt; Figure a c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Figure a a -&gt; Figure a b -&gt; Figure a c
$c*&gt; :: forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a b
*&gt; :: forall a b. Figure a a -&gt; Figure a b -&gt; Figure a b
$c&lt;* :: forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a a
&lt;* :: forall a b. Figure a a -&gt; Figure a b -&gt; Figure a a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268885"><span id="local-6989586621679268891"><span id="local-6989586621679268896"><span class="annot"><span class="annottext">Applicative (Figure a)
Applicative (Figure a)
-&gt; (forall a b. Figure a a -&gt; (a -&gt; Figure a b) -&gt; Figure a b)
-&gt; (forall a b. Figure a a -&gt; Figure a b -&gt; Figure a b)
-&gt; (forall a. a -&gt; Figure a a)
-&gt; Monad (Figure a)
forall a. Applicative (Figure a)
forall a. a -&gt; Figure a a
forall a a. a -&gt; Figure a a
forall a b. Figure a a -&gt; Figure a b -&gt; Figure a b
forall a b. Figure a a -&gt; (a -&gt; Figure a b) -&gt; Figure a b
forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a b
forall a a b. Figure a a -&gt; (a -&gt; Figure a b) -&gt; Figure a b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall a a b. Figure a a -&gt; (a -&gt; Figure a b) -&gt; Figure a b
&gt;&gt;= :: forall a b. Figure a a -&gt; (a -&gt; Figure a b) -&gt; Figure a b
$c&gt;&gt; :: forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a b
&gt;&gt; :: forall a b. Figure a a -&gt; Figure a b -&gt; Figure a b
$creturn :: forall a a. a -&gt; Figure a a
return :: forall a. a -&gt; Figure a a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679268418"><span id="local-6989586621679268419"><span id="local-6989586621679268904"><span id="local-6989586621679268908"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679268418"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268418"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268419"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679268917"><span class="annot"><span class="annottext">[([a], [Attribute])]
</span><a href="#local-6989586621679268917"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268918"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679268918"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679268919"><span class="annot"><span class="annottext">&lt;&gt; :: Figure a b -&gt; Figure a b -&gt; Figure a b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679268920"><span class="annot"><span class="annottext">[([a], [Attribute])]
</span><a href="#local-6989586621679268920"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([([a], [Attribute])], b) -&gt; Figure a b
forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[([a], [Attribute])]
</span><a href="#local-6989586621679268917"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">[([a], [Attribute])]
-&gt; [([a], [Attribute])] -&gt; [([a], [Attribute])]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">[([a], [Attribute])]
</span><a href="#local-6989586621679268920"><span class="hs-identifier hs-var">f2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679268918"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679268426"><span id="local-6989586621679268427"><span id="local-6989586621679268926"><span id="local-6989586621679268930"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679268426"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268426"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268427"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679268936"><span class="annot"><span class="annottext">mempty :: Figure a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([([a], [Attribute])], b) -&gt; Figure a b
forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[([a], [Attribute])]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679268432"><span id="local-6989586621679268433"><span class="annot"><span class="hs-identifier hs-type">With</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268432"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268433"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679268941"><span class="annot"><span class="annottext">with :: Figure a b -&gt; [Attribute] -&gt; Figure a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">with</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679268942"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679268942"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268943"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268943"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268944"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679268944"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679268945"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268945"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="annottext">([([a], [Attribute])], b) -&gt; Figure a b
forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679268942"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268943"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Attribute] -&gt; [Attribute]
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268945"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679268944"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>    </span><span>
</span><span id="line-129"></span><span class="annot"><span class="hs-comment">-- | Returns list of graphic objects with attributes.</span></span><span>
</span><span id="line-130"></span><span id="local-6989586621679268434"><span id="local-6989586621679268435"><span class="annot"><a href="Algeometry.SVG.html#getFigure"><span class="hs-identifier hs-type">getFigure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268434"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268435"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679268434"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-131"></span><span id="getFigure"><span class="annot"><span class="annottext">getFigure :: forall a b. Figure a b -&gt; [([a], [Attribute])]
</span><a href="Algeometry.SVG.html#getFigure"><span class="hs-identifier hs-var hs-var">getFigure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span id="local-6989586621679268946"><span class="annot"><span class="annottext">([([a], [Attribute])], b)
</span><a href="#local-6989586621679268946"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([([a], [Attribute])], b) -&gt; [([a], [Attribute])]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([([a], [Attribute])], b)
</span><a href="#local-6989586621679268946"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><span class="hs-comment">-- | Returns value, stored in Figure type.</span></span><span>
</span><span id="line-134"></span><span id="local-6989586621679268440"><span id="local-6989586621679268441"><span class="annot"><a href="Algeometry.SVG.html#getResult"><span class="hs-identifier hs-type">getResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268441"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268441"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-135"></span><span id="getResult"><span class="annot"><span class="annottext">getResult :: forall a b. Figure a b -&gt; b
</span><a href="Algeometry.SVG.html#getResult"><span class="hs-identifier hs-var hs-var">getResult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span id="local-6989586621679268948"><span class="annot"><span class="annottext">([([a], [Attribute])], b)
</span><a href="#local-6989586621679268948"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([([a], [Attribute])], b) -&gt; b
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([([a], [Attribute])], b)
</span><a href="#local-6989586621679268948"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><span class="hs-comment">-- | Applies transformation to objects, stored in Figure type.</span></span><span>
</span><span id="line-138"></span><span id="local-6989586621679268446"><span id="local-6989586621679268447"><span id="local-6989586621679268448"><span class="annot"><a href="Algeometry.SVG.html#mapFig"><span class="hs-identifier hs-type">mapFig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679268446"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268447"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268446"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268448"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268447"><span class="hs-identifier hs-type">a2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268448"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-139"></span><span id="mapFig"><span class="annot"><span class="annottext">mapFig :: forall a1 a2 b. (a1 -&gt; a2) -&gt; Figure a1 b -&gt; Figure a2 b
</span><a href="Algeometry.SVG.html#mapFig"><span class="hs-identifier hs-var hs-var">mapFig</span></a></span></span><span> </span><span id="local-6989586621679268950"><span class="annot"><span class="annottext">a1 -&gt; a2
</span><a href="#local-6989586621679268950"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679268951"><span class="annot"><span class="annottext">[([a1], [Attribute])]
</span><a href="#local-6989586621679268951"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268952"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679268952"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([([a2], [Attribute])], b) -&gt; Figure a2 b
forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([a1], [Attribute]) -&gt; ([a2], [Attribute]))
-&gt; [([a1], [Attribute])] -&gt; [([a2], [Attribute])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679268953"><span class="annot"><span class="annottext">[a1]
</span><a href="#local-6989586621679268953"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679268954"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268954"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a1 -&gt; a2) -&gt; [a1] -&gt; [a2]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; a2
</span><a href="#local-6989586621679268950"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a1]
</span><a href="#local-6989586621679268953"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268954"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([a1], [Attribute])]
</span><a href="#local-6989586621679268951"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679268952"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><span class="hs-comment">-- | Adds multivector as graphic object to Figure.</span></span><span>
</span><span id="line-142"></span><span id="local-6989586621679268454"><span class="annot"><a href="Algeometry.SVG.html#put"><span class="hs-identifier hs-type">put</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679268454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268454"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-143"></span><span id="put"><span class="annot"><span class="annottext">put :: forall a. a -&gt; Figure a a
</span><a href="Algeometry.SVG.html#put"><span class="hs-identifier hs-var hs-var">put</span></a></span></span><span> </span><span id="local-6989586621679268955"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679268955"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([([a], [Attribute])], a) -&gt; Figure a a
forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679268955"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679268955"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><span class="hs-comment">-- | Adds multivectors as graphic object to Figure.</span></span><span>
</span><span id="line-146"></span><span id="local-6989586621679268456"><span class="annot"><a href="Algeometry.SVG.html#puts"><span class="hs-identifier hs-type">puts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679268456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268456"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679268456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-147"></span><span id="puts"><span class="annot"><span class="annottext">puts :: forall a. [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#puts"><span class="hs-identifier hs-var hs-var">puts</span></a></span></span><span> </span><span id="local-6989586621679268957"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679268957"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([([a], [Attribute])], [a]) -&gt; Figure a [a]
forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679268957"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679268957"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-type">@</span></a></span><span>
</span><span id="line-150"></span><span class="annot"><span class="hs-comment">-- | Adds multivector as graphic object with given attributes.</span></span><span>
</span><span id="line-151"></span><span id="local-6989586621679268458"><span class="annot"><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-type">(@)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679268458"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268458"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268458"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-152"></span><span id="local-6989586621679268959"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679268959"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="%40"><span class="annot"><span class="annottext">@ :: forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var hs-var">@</span></a></span></span><span> </span><span id="local-6989586621679268960"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268960"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Figure a a
forall a. a -&gt; Figure a a
</span><a href="Algeometry.SVG.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679268959"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Figure a a -&gt; [Attribute] -&gt; Figure a a
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679268960"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#%3C%40"><span class="hs-operator hs-type">&lt;@</span></a></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">-- | Appends attributes to attributed object.</span></span><span>
</span><span id="line-156"></span><span id="local-6989586621679268961"><span id="local-6989586621679268962"><span class="annot"><a href="Algeometry.SVG.html#%3C%40"><span class="hs-operator hs-type">(&lt;@)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268961"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268962"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268961"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268962"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-157"></span><span id="%3C%40"><span class="annot"><span class="annottext">&lt;@ :: forall a b. Figure a b -&gt; [Attribute] -&gt; Figure a b
</span><a href="Algeometry.SVG.html#%3C%40"><span class="hs-operator hs-var hs-var">(&lt;@)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Figure a b -&gt; [Attribute] -&gt; Figure a b
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-identifier hs-var">with</span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">------------------------------</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- geometric objects</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><span class="hs-comment">-- | Returns multivector, which represents the origin.</span></span><span>
</span><span id="line-163"></span><span id="local-6989586621679268462"><span class="annot"><a href="Algeometry.SVG.html#origin"><span class="hs-identifier hs-type">origin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268462"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268462"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-164"></span><span id="origin"><span class="annot"><span class="annottext">origin :: forall a. GeomAlgebra a =&gt; a
</span><a href="Algeometry.SVG.html#origin"><span class="hs-identifier hs-var hs-var">origin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><span class="hs-comment">-- | Returns a label with given value.</span></span><span>
</span><span id="line-167"></span><span id="local-6989586621679268464"><span id="local-6989586621679268465"><span class="annot"><a href="Algeometry.SVG.html#display"><span class="hs-identifier hs-type">display</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679268464"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268465"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268464"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268465"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-168"></span><span id="display"><span class="annot"><span class="annottext">display :: forall s a. (Show s, GeomAlgebra a) =&gt; [Double] -&gt; s -&gt; Figure a a
</span><a href="Algeometry.SVG.html#display"><span class="hs-identifier hs-var hs-var">display</span></a></span></span><span> </span><span id="local-6989586621679268970"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268970"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679268971"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679268971"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; String -&gt; Figure a a
forall a. GeomAlgebra a =&gt; [Double] -&gt; String -&gt; Figure a a
</span><a href="Algeometry.SVG.html#label"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268970"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Figure a a) -&gt; String -&gt; Figure a a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679268971"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><span class="hs-comment">-- | Returns a label at given position.</span></span><span>
</span><span id="line-171"></span><span id="local-6989586621679268468"><span class="annot"><a href="Algeometry.SVG.html#label"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268468"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268468"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268468"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-172"></span><span id="label"><span class="annot"><span class="annottext">label :: forall a. GeomAlgebra a =&gt; [Double] -&gt; String -&gt; Figure a a
</span><a href="Algeometry.SVG.html#label"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679268976"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268976"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679268977"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268977"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268976"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Attribute] -&gt; Figure a a
forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">id_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679268977"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;label&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="annot"><span class="hs-comment">-- | Returns multivector, which represents a normalized line.</span></span><span>
</span><span id="line-175"></span><span id="local-6989586621679268473"><span class="annot"><a href="Algeometry.SVG.html#nline"><span class="hs-identifier hs-type">nline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268473"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268473"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-176"></span><span id="nline"><span class="annot"><span class="annottext">nline :: forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#nline"><span class="hs-identifier hs-var hs-var">nline</span></a></span></span><span> </span><span id="local-6989586621679268984"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268984"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679268985"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268985"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268984"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268985"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="annot"><span class="hs-comment">-- | Returns multivector, which represents a line.</span></span><span>
</span><span id="line-179"></span><span id="local-6989586621679268987"><span class="annot"><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-type">line</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268987"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268987"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-180"></span><span id="line"><span class="annot"><span class="annottext">line :: forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span id="local-6989586621679268992"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268992"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679268993"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268993"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268992"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#%2228"><span class="hs-operator hs-var">&#8744;</span></a></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679268993"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><span class="hs-comment">-- | Returns multivector, which represents a vector (line passing through the origin).</span></span><span>
</span><span id="line-183"></span><span id="local-6989586621679268995"><span class="annot"><a href="Algeometry.SVG.html#vect"><span class="hs-identifier hs-type">vect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268995"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-184"></span><span id="vect"><span class="annot"><span class="annottext">vect :: forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.SVG.html#vect"><span class="hs-identifier hs-var hs-var">vect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; a
forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><span class="hs-comment">-- | Returns multivector, which represents a normalized vector (line passing through the origin).</span></span><span>
</span><span id="line-187"></span><span id="local-6989586621679268998"><span class="annot"><a href="Algeometry.SVG.html#nvect"><span class="hs-identifier hs-type">nvect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268998"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268998"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-188"></span><span id="nvect"><span class="annot"><span class="annottext">nvect :: forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.SVG.html#nvect"><span class="hs-identifier hs-var hs-var">nvect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; a
forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#nline"><span class="hs-identifier hs-var">nline</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="annot"><span class="hs-comment">-- | Returns a graphic object, which represents a polygon.</span></span><span>
</span><span id="line-191"></span><span id="local-6989586621679268479"><span class="annot"><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268479"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679268479"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268479"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679268479"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-192"></span><span id="polygon"><span class="annot"><span class="annottext">polygon :: forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-var hs-var">polygon</span></a></span></span><span> </span><span id="local-6989586621679269017"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679269017"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Figure a [a]
</span><a href="#local-6989586621679269018"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Figure a [a] -&gt; [Attribute] -&gt; Figure a [a]
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;polygon&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679269018"><span class="annot"><span class="annottext">res :: Figure a [a]
</span><a href="#local-6989586621679269018"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679269017"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>      </span><span id="local-6989586621679269030"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269030"><span class="hs-identifier hs-var">h</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isPoint"><span class="hs-identifier hs-var">isPoint</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269030"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Figure a [a]
forall a. [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#puts"><span class="hs-identifier hs-var">puts</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679269017"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-196"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isLine"><span class="hs-identifier hs-var">isLine</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269030"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679269043"><span class="annot"><span class="annottext">pts' :: [a]
</span><a href="#local-6989586621679269043"><span class="hs-identifier hs-var hs-var">pts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. CliffAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#outer"><span class="hs-identifier hs-var">outer</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679269017"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679269017"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269030"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679269017"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; Figure a [a] -&gt; Figure a [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Figure a [a]
forall a. [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#puts"><span class="hs-identifier hs-var">puts</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679269043"><span class="hs-identifier hs-var">pts'</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Figure a [a]
forall a. [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#puts"><span class="hs-identifier hs-var">puts</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679269017"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><span class="hs-comment">-- | Returns a graphic object, which represents a polyline.</span></span><span>
</span><span id="line-202"></span><span id="local-6989586621679269047"><span class="annot"><a href="Algeometry.SVG.html#polyline"><span class="hs-identifier hs-type">polyline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679269047"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679269047"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679269047"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679269047"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-203"></span><span id="polyline"><span class="annot"><span class="annottext">polyline :: forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polyline"><span class="hs-identifier hs-var hs-var">polyline</span></a></span></span><span> </span><span id="local-6989586621679269052"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679269052"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Figure a [a]
forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-var">polygon</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679269052"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">Figure a [a] -&gt; [Attribute] -&gt; Figure a [a]
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;polyline&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><span class="hs-comment">-- | Returns a graphic object, which represents a regular polygon.</span></span><span>
</span><span id="line-206"></span><span id="local-6989586621679268490"><span class="annot"><a href="Algeometry.SVG.html#regularPoly"><span class="hs-identifier hs-type">regularPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268490"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268490"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679268490"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-207"></span><span id="regularPoly"><span class="annot"><span class="annottext">regularPoly :: forall a. GeomAlgebra a =&gt; Double -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#regularPoly"><span class="hs-identifier hs-var hs-var">regularPoly</span></a></span></span><span> </span><span id="local-6989586621679269075"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269075"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Figure a [a]
forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-var">polygon</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269079"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269079"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679269079"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269079"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269075"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269075"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269075"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><span class="hs-comment">-- | Returns a graphic object, which represents a segment? given by two points.</span></span><span>
</span><span id="line-211"></span><span id="local-6989586621679268495"><span class="annot"><a href="Algeometry.SVG.html#segment"><span class="hs-identifier hs-type">segment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268495"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268495"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268495"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268495"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679268495"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-212"></span><span id="segment"><span class="annot"><span class="annottext">segment :: forall a. GeomAlgebra a =&gt; a -&gt; a -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#segment"><span class="hs-identifier hs-var hs-var">segment</span></a></span></span><span> </span><span id="local-6989586621679269084"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269084"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679269085"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269085"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Figure a [a]
forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polyline"><span class="hs-identifier hs-var">polyline</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269084"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269085"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="annot"><span class="hs-comment">-- | Returns a graphic object, which represents a segment given by coordinates.</span></span><span>
</span><span id="line-215"></span><span id="local-6989586621679268497"><span class="annot"><a href="Algeometry.SVG.html#segm"><span class="hs-identifier hs-type">segm</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268497"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268497"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679268497"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-218"></span><span id="segm"><span class="annot"><span class="annottext">segm :: forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#segm"><span class="hs-identifier hs-var hs-var">segm</span></a></span></span><span> </span><span id="local-6989586621679269090"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269090"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679269091"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269091"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Figure a [a]
forall a. GeomAlgebra a =&gt; a -&gt; a -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#segment"><span class="hs-identifier hs-var">segment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269090"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269091"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><span class="hs-comment">-- | Returns multivector, which represents a plane passing through three points.</span></span><span>
</span><span id="line-221"></span><span id="local-6989586621679268499"><span class="annot"><a href="Algeometry.SVG.html#plane"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268499"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268499"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-223"></span><span id="plane"><span class="annot"><span class="annottext">plane :: forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#plane"><span class="hs-identifier hs-var hs-var">plane</span></a></span></span><span> </span><span id="local-6989586621679269098"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269098"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679269099"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269099"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679269100"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269100"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269098"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269099"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; a
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269100"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="annot"><span class="hs-comment">-- | Returns graphic object, which represents a plane passing through a point and a line.</span></span><span>
</span><span id="line-226"></span><span id="local-6989586621679268501"><span class="annot"><a href="Algeometry.SVG.html#plane2"><span class="hs-identifier hs-type">plane2</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679268501"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268501"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268501"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268501"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268501"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268501"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-230"></span><span id="plane2"><span class="annot"><span class="annottext">plane2 :: forall a.
(Fractional a, GeomAlgebra a) =&gt;
a -&gt; a -&gt; XY -&gt; Figure a a
</span><a href="Algeometry.SVG.html#plane2"><span class="hs-identifier hs-var hs-var">plane2</span></a></span></span><span> </span><span id="local-6989586621679269134"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269134"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679269135"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269135"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269136"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269136"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269137"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269137"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; Figure a [a]
forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-var">polygon</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; Double -&gt; a -&gt; a
forall mv.
(GeomAlgebra mv, Fractional mv) =&gt;
mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269139"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269137"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Double -&gt; a -&gt; a
forall mv.
(GeomAlgebra mv, Fractional mv) =&gt;
mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269135"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269136"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269134"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-232"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Double -&gt; a -&gt; a
forall mv.
(GeomAlgebra mv, Fractional mv) =&gt;
mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269139"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269137"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Double -&gt; a -&gt; a
forall mv.
(GeomAlgebra mv, Fractional mv) =&gt;
mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269135"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269136"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269134"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Double -&gt; a -&gt; a
forall mv.
(GeomAlgebra mv, Fractional mv) =&gt;
mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269139"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269137"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Double -&gt; a -&gt; a
forall mv.
(GeomAlgebra mv, Fractional mv) =&gt;
mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269135"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269136"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269140"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Double -&gt; a -&gt; a
forall mv.
(GeomAlgebra mv, Fractional mv) =&gt;
mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269139"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269137"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Double -&gt; a -&gt; a
forall mv.
(GeomAlgebra mv, Fractional mv) =&gt;
mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269135"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269136"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269140"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; Figure a a
forall a. a -&gt; Figure a a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269134"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#%2228"><span class="hs-operator hs-var">&#8744;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269135"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679269140"><span class="annot"><span class="annottext">p' :: a
</span><a href="#local-6989586621679269140"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269134"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#-%3E%7C"><span class="hs-operator hs-var">-&gt;|</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269135"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621679269139"><span class="annot"><span class="annottext">l' :: a
</span><a href="#local-6989586621679269139"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269134"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269140"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><span class="hs-comment">-- | Returns graphic object, which represents a plane passing through a point, orthogonal to a line.</span></span><span>
</span><span id="line-241"></span><span id="local-6989586621679269160"><span class="annot"><a href="Algeometry.SVG.html#orthoPlane"><span class="hs-identifier hs-type">orthoPlane</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679269160"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679269160"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679269160"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679269160"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679269160"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679269160"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-245"></span><span id="orthoPlane"><span class="annot"><span class="annottext">orthoPlane :: forall a.
(Fractional a, GeomAlgebra a) =&gt;
a -&gt; a -&gt; XY -&gt; Figure a a
</span><a href="Algeometry.SVG.html#orthoPlane"><span class="hs-identifier hs-var hs-var">orthoPlane</span></a></span></span><span> </span><span id="local-6989586621679269172"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269172"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679269173"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269173"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; XY -&gt; Figure a a
forall a.
(Fractional a, GeomAlgebra a) =&gt;
a -&gt; a -&gt; XY -&gt; Figure a a
</span><a href="Algeometry.SVG.html#plane2"><span class="hs-identifier hs-var">plane2</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269172"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269174"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621679269184"><span class="annot"><span class="annottext">p' :: a
</span><a href="#local-6989586621679269184"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269172"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#-%3E%7C"><span class="hs-operator hs-var">-&gt;|</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269173"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679269174"><span class="annot"><span class="annottext">l :: a
</span><a href="#local-6989586621679269174"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269184"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. CliffAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#inner"><span class="hs-operator hs-var">`inner`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269172"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269173"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><span class="hs-comment">-- | Returns graphic object, which represents a plane passing through three points.</span></span><span>
</span><span id="line-251"></span><span id="local-6989586621679268505"><span class="annot"><a href="Algeometry.SVG.html#plane3"><span class="hs-identifier hs-type">plane3</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679268505"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268505"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268505"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268505"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268505"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268505"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268505"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-255"></span><span id="plane3"><span class="annot"><span class="annottext">plane3 :: forall a.
(Fractional a, GeomAlgebra a) =&gt;
a -&gt; a -&gt; a -&gt; XY -&gt; Figure a a
</span><a href="Algeometry.SVG.html#plane3"><span class="hs-identifier hs-var hs-var">plane3</span></a></span></span><span> </span><span id="local-6989586621679269208"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269208"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679269209"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269209"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679269210"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269210"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; XY -&gt; Figure a a
forall a.
(Fractional a, GeomAlgebra a) =&gt;
a -&gt; a -&gt; XY -&gt; Figure a a
</span><a href="Algeometry.SVG.html#plane2"><span class="hs-identifier hs-var">plane2</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269208"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269209"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269210"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- rplane</span><span>
</span><span id="line-258"></span><span class="hs-comment">--   :: (Fractional a, GeomAlgebra a)</span><span>
</span><span id="line-259"></span><span class="hs-comment">--   =&gt; a -&gt; Double -&gt; String -&gt; String</span><span>
</span><span id="line-260"></span><span class="hs-comment">--   -&gt; Figure a a</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- rplane p r col lab = do</span><span>
</span><span id="line-262"></span><span class="hs-comment">--   polygon pts attr'</span><span>
</span><span id="line-263"></span><span class="hs-comment">--   sequence [ segment p0 pt attr' | pt &lt;- pts ]</span><span>
</span><span id="line-264"></span><span class="hs-comment">--   if not (null lab)</span><span>
</span><span id="line-265"></span><span class="hs-comment">--     then p2 @ [stroke_width_ &quot;0&quot;, fill_ &quot;none&quot;, id_ (pack lab)]</span><span>
</span><span id="line-266"></span><span class="hs-comment">--     else return p</span><span>
</span><span id="line-267"></span><span class="hs-comment">--   return p</span><span>
</span><span id="line-268"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-269"></span><span class="hs-comment">--     p0 = point [] -&gt;| p</span><span>
</span><span id="line-270"></span><span class="hs-comment">--     p1 = point [log 2, sqrt 2, sin 2] -&gt;| p</span><span>
</span><span id="line-271"></span><span class="hs-comment">--     p2 = shiftAlong' (p0 `join` p1) r p0</span><span>
</span><span id="line-272"></span><span class="hs-comment">--     n = point [] |- p</span><span>
</span><span id="line-273"></span><span class="hs-comment">--     pts = [ rotateAt n a p2 | a &lt;- [0,pi/20..2*pi] ]</span><span>
</span><span id="line-274"></span><span class="hs-comment">--     attr' = [fill_ (pack col), stroke_ (pack col), opacity_ &quot;0.25&quot;]</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><span class="hs-comment">-- | Adds 2D axes to a Figure</span></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Algeometry.SVG.html#axis"><span class="hs-identifier hs-type">axis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span>
</span><span id="line-278"></span><span id="axis"><span class="annot"><span class="annottext">axis :: Figure PGA2 PGA2
</span><a href="Algeometry.SVG.html#axis"><span class="hs-identifier hs-var hs-var">axis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; PGA2
forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; [Attribute] -&gt; Figure PGA2 PGA2
forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;0.25&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; PGA2
forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; [Attribute] -&gt; Figure PGA2 PGA2
forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;0.25&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><span class="hs-comment">-- | Adds 2D unit grid to a Figure</span></span><span>
</span><span id="line-283"></span><span class="annot"><a href="Algeometry.SVG.html#grid"><span class="hs-identifier hs-type">grid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span id="grid"><span class="annot"><span class="annottext">grid :: Figure PGA2 ()
</span><a href="Algeometry.SVG.html#grid"><span class="hs-identifier hs-var hs-var">grid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; PGA2
forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; [Attribute] -&gt; Figure PGA2 PGA2
forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269212"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; PGA2
forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; [Attribute] -&gt; Figure PGA2 PGA2
forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269212"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><span class="annottext">(Double -&gt; Figure PGA2 PGA2) -&gt; [Double] -&gt; Figure PGA2 ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 PGA2
forall {b}. GeomAlgebra b =&gt; Double -&gt; Figure b b
</span><a href="#local-6989586621679269214"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">19</span></span><span class="hs-special">]</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621679269214"><span class="annot"><span class="annottext">mk :: Double -&gt; Figure b b
</span><a href="#local-6989586621679269214"><span class="hs-identifier hs-var hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679269242"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269242"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; b
forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269242"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269242"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">b -&gt; [Attribute] -&gt; Figure b b
forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269212"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; b
forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269242"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269242"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">b -&gt; [Attribute] -&gt; Figure b b
forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269212"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; b
forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269242"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269242"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">b -&gt; [Attribute] -&gt; Figure b b
forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269212"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; b
forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269242"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269242"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">b -&gt; [Attribute] -&gt; Figure b b
forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269212"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621679269212"><span class="annot"><span class="annottext">attr :: [Attribute]
</span><a href="#local-6989586621679269212"><span class="hs-identifier hs-var hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;lightgray&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;0.2&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><span class="hs-comment">-- | Adds 2D background rectangle to a Figure</span></span><span>
</span><span id="line-297"></span><span id="local-6989586621679268512"><span class="annot"><a href="Algeometry.SVG.html#background"><span class="hs-identifier hs-type">background</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679268512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-298"></span><span id="background"><span class="annot"><span class="annottext">background :: forall a. GeomAlgebra a =&gt; String -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#background"><span class="hs-identifier hs-var hs-var">background</span></a></span></span><span> </span><span id="local-6989586621679269250"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269250"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Figure a [a]
forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-var">polygon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Figure a [a] -&gt; [Attribute] -&gt; Figure a [a]
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;bg&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269250"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-299"></span><span>    </span><span>
</span><span id="line-300"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-301"></span><span class="annot"><span class="hs-comment">-- | Returns a figure as a list of primitives.</span></span><span>
</span><span id="line-302"></span><span id="local-6989586621679268514"><span class="annot"><a href="Algeometry.SVG.html#figure"><span class="hs-identifier hs-type">figure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268514"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-type">Fig</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-303"></span><span id="figure"><span class="annot"><span class="annottext">figure :: forall b. Figure PGA2 b -&gt; [Fig]
</span><a href="Algeometry.SVG.html#figure"><span class="hs-identifier hs-var hs-var">figure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([PGA2], [Attribute]) -&gt; [Fig])
-&gt; [([PGA2], [Attribute])] -&gt; [Fig]
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">([PGA2], [Attribute]) -&gt; [Fig]
</span><a href="#local-6989586621679269255"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">([([PGA2], [Attribute])] -&gt; [Fig])
-&gt; (Figure PGA2 b -&gt; [([PGA2], [Attribute])])
-&gt; Figure PGA2 b
-&gt; [Fig]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Figure PGA2 b -&gt; [([PGA2], [Attribute])]
forall a b. Figure a b -&gt; [([a], [Attribute])]
</span><a href="Algeometry.SVG.html#getFigure"><span class="hs-identifier hs-var">getFigure</span></a></span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-305"></span><span>    </span><span id="local-6989586621679269255"><span class="annot"><span class="annottext">draw :: ([PGA2], [Attribute]) -&gt; [Fig]
</span><a href="#local-6989586621679269255"><span class="hs-identifier hs-var hs-var">draw</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269271"><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679269271"><span class="hs-identifier hs-var">mvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269272"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269272"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679269271"><span class="hs-identifier hs-var">mvs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-306"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679269273"><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679269273"><span class="hs-identifier hs-var">mv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; Bool
forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isPoint"><span class="hs-identifier hs-var">isPoint</span></a></span><span> </span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679269273"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Attribute] -&gt; XY -&gt; Fig
</span><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269272"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">(XY -&gt; Fig) -&gt; XY -&gt; Fig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; XY
forall {mv}. GeomAlgebra mv =&gt; mv -&gt; XY
</span><a href="#local-6989586621679269274"><span class="hs-identifier hs-var">xy</span></a></span><span> </span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679269273"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; Bool
forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isLine"><span class="hs-identifier hs-var">isLine</span></a></span><span> </span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679269273"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[XY] -&gt; [XY]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGA2 -&gt; XY
forall {mv}. GeomAlgebra mv =&gt; mv -&gt; XY
</span><a href="#local-6989586621679269274"><span class="hs-identifier hs-var">xy</span></a></span><span> </span><span class="annot"><span class="annottext">(PGA2 -&gt; XY) -&gt; [PGA2] -&gt; [XY]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; [PGA2]
</span><a href="Algeometry.SVG.html#clip"><span class="hs-identifier hs-var">clip</span></a></span><span> </span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679269273"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-308"></span><span>               </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-309"></span><span>               </span><span class="hs-special">[</span><span id="local-6989586621679269275"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269275"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Attribute] -&gt; XY -&gt; Fig
</span><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269272"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269275"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>               </span><span id="local-6989586621679269276"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269276"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679269277"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269277"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[XY]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Attribute] -&gt; XY -&gt; XY -&gt; Fig
</span><a href="Algeometry.SVG.html#Line"><span class="hs-identifier hs-var">Line</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269272"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269276"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269277"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-311"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>      </span><span class="annot"><span class="annottext">[PGA2]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(PGA2 -&gt; Bool) -&gt; [PGA2] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; Bool
forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isPoint"><span class="hs-identifier hs-var">isPoint</span></a></span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679269271"><span class="hs-identifier hs-var">mvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Attribute] -&gt; [XY] -&gt; Fig
</span><a href="Algeometry.SVG.html#Polygon"><span class="hs-identifier hs-var">Polygon</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269272"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">([XY] -&gt; Fig) -&gt; [XY] -&gt; Fig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; XY
forall {mv}. GeomAlgebra mv =&gt; mv -&gt; XY
</span><a href="#local-6989586621679269274"><span class="hs-identifier hs-var">xy</span></a></span><span> </span><span class="annot"><span class="annottext">(PGA2 -&gt; XY) -&gt; [PGA2] -&gt; [XY]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679269271"><span class="hs-identifier hs-var">mvs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679269271"><span class="hs-identifier hs-var">mvs</span></a></span><span> </span><span class="annot"><span class="annottext">[PGA2] -&gt; (PGA2 -&gt; [Fig]) -&gt; [Fig]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679269279"><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679269279"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([PGA2], [Attribute]) -&gt; [Fig]
</span><a href="#local-6989586621679269255"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679269279"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269272"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>      </span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679269274"><span class="annot"><span class="annottext">xy :: mv -&gt; XY
</span><a href="#local-6989586621679269274"><span class="hs-identifier hs-var hs-var">xy</span></a></span></span><span> </span><span id="local-6989586621679269300"><span class="annot"><span class="annottext">mv
</span><a href="#local-6989586621679269300"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">mv -&gt; [Double]
forall mv. GeomAlgebra mv =&gt; mv -&gt; [Double]
</span><a href="Algeometry.GeometricAlgebra.html#coord"><span class="hs-identifier hs-var">coord</span></a></span><span> </span><span class="annot"><span class="annottext">mv
</span><a href="#local-6989586621679269300"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679269302"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269302"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269302"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>      </span><span id="local-6989586621679269303"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269303"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679269304"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269304"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269303"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269304"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="annot"><span class="hs-comment">-- | Projects 3D points to a 2D plane, using given viewpoint.</span></span><span>
</span><span id="line-321"></span><span id="local-6989586621679268526"><span class="annot"><a href="Algeometry.SVG.html#viewPoint"><span class="hs-identifier hs-type">viewPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA3"><span class="hs-identifier hs-type">PGA3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268526"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268526"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-322"></span><span id="viewPoint"><span class="annot"><span class="annottext">viewPoint :: forall b. [Double] -&gt; Figure PGA3 b -&gt; Figure PGA2 b
</span><a href="Algeometry.SVG.html#viewPoint"><span class="hs-identifier hs-var hs-var">viewPoint</span></a></span></span><span> </span><span id="local-6989586621679269306"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269306"><span class="hs-identifier hs-var">vp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PGA3 -&gt; PGA2) -&gt; Figure PGA3 b -&gt; Figure PGA2 b
forall a1 a2 b. (a1 -&gt; a2) -&gt; Figure a1 b -&gt; Figure a2 b
</span><a href="Algeometry.SVG.html#mapFig"><span class="hs-identifier hs-var">mapFig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGA3 -&gt; PGA2
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(PGA3 -&gt; PGA2) -&gt; (PGA3 -&gt; PGA3) -&gt; PGA3 -&gt; PGA2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3
</span><a href="#local-6989586621679269307"><span class="hs-identifier hs-var">project</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679269331"><span class="annot"><span class="annottext">p0 :: PGA3
</span><a href="#local-6989586621679269331"><span class="hs-identifier hs-var hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3
forall mv. CliffAlgebra mv =&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#dual"><span class="hs-identifier hs-var">dual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; PGA3
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269306"><span class="hs-identifier hs-var">vp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621679269307"><span class="annot"><span class="annottext">project :: PGA3 -&gt; PGA3
</span><a href="#local-6989586621679269307"><span class="hs-identifier hs-var hs-var">project</span></a></span></span><span> </span><span id="local-6989586621679269361"><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269361"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; Bool
forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isPoint"><span class="hs-identifier hs-var">isPoint</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269361"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269361"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3 -&gt; PGA3
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; PGA3
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269306"><span class="hs-identifier hs-var">vp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3 -&gt; PGA3
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#meet"><span class="hs-operator hs-var">`meet`</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269331"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3 -&gt; PGA3
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269331"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-327"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; Bool
forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isLine"><span class="hs-identifier hs-var">isLine</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269361"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269361"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3 -&gt; PGA3
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; PGA3
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269306"><span class="hs-identifier hs-var">vp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3 -&gt; PGA3
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#meet"><span class="hs-operator hs-var">`meet`</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269331"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3 -&gt; PGA3
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269331"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-328"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269361"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3 -&gt; PGA3
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; PGA3
forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269306"><span class="hs-identifier hs-var">vp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3 -&gt; PGA3
forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#meet"><span class="hs-operator hs-var">`meet`</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269331"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3 -&gt; PGA3
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679269331"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span id="rescaleTo"><span class="annot"><span class="annottext">rescaleTo :: XY -&gt; Fig -&gt; Fig
</span><a href="Algeometry.SVG.html#rescaleTo"><span class="hs-identifier hs-var hs-var">rescaleTo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269365"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269365"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679269366"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269366"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679269367"><span class="annot"><span class="annottext">Fig
</span><a href="#local-6989586621679269367"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Fig
</span><a href="#local-6989586621679269367"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679269368"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269368"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679269369"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269369"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; XY -&gt; Fig
</span><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269368"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XY -&gt; XY
</span><a href="#local-6989586621679269370"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269369"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span id="local-6989586621679269371"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269371"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679269372"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269372"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679269373"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269373"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; XY -&gt; XY -&gt; Fig
</span><a href="Algeometry.SVG.html#Line"><span class="hs-identifier hs-var">Line</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269371"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XY -&gt; XY
</span><a href="#local-6989586621679269370"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269372"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XY -&gt; XY
</span><a href="#local-6989586621679269370"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269373"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span id="local-6989586621679269374"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269374"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679269375"><span class="annot"><span class="annottext">[XY]
</span><a href="#local-6989586621679269375"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [XY] -&gt; Fig
</span><a href="Algeometry.SVG.html#Polygon"><span class="hs-identifier hs-var">Polygon</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269374"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XY -&gt; XY
</span><a href="#local-6989586621679269370"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">(XY -&gt; XY) -&gt; [XY] -&gt; [XY]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[XY]
</span><a href="#local-6989586621679269375"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679269370"><span class="annot"><span class="annottext">sc :: XY -&gt; XY
</span><a href="#local-6989586621679269370"><span class="hs-identifier hs-var hs-var">sc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269394"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269394"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679269395"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269395"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269365"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269394"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269365"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269366"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269395"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269366"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span id="local-6989586621679268530"><span class="annot"><a href="Algeometry.SVG.html#renderFig"><span class="hs-identifier hs-type">renderFig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679268530"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-type">Fig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HtmlT</span></span><span> </span><span class="annot"><a href="#local-6989586621679268530"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-340"></span><span id="renderFig"><span class="annot"><span class="annottext">renderFig :: forall (m :: * -&gt; *). Monad m =&gt; Fig -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#renderFig"><span class="hs-identifier hs-var hs-var">renderFig</span></a></span></span><span> </span><span id="local-6989586621679269471"><span class="annot"><span class="annottext">Fig
</span><a href="#local-6989586621679269471"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Fig
</span><a href="#local-6989586621679269471"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-341"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679269472"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269472"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269473"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269473"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269474"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269474"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Text]
</span><a href="#local-6989586621679269475"><span class="hs-identifier hs-var">getClass</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269472"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;label&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HtmlT m ()
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-344"></span><span>      </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-345"></span><span>        </span><span class="annot"><span class="annottext">[Attribute] -&gt; HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">circle_</span></span><span> </span><span class="annot"><span class="annottext">([Attribute] -&gt; HtmlT m ()) -&gt; [Attribute] -&gt; HtmlT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">cx_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269473"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">cy_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269474"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">r_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;2.25&quot;</span></span><span>
</span><span id="line-348"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;black&quot;</span></span><span>
</span><span id="line-349"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;white&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Attribute] -&gt; [Attribute]
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269472"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Text]
</span><a href="#local-6989586621679269480"><span class="hs-identifier hs-var">getId</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269472"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679269481"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679269481"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; XY -&gt; HtmlT m ()
forall a (m :: * -&gt; *).
(ToHtml a, Monad m) =&gt;
a -&gt; XY -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#mkLabel"><span class="hs-identifier hs-var">mkLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679269481"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269473"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269474"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>      </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HtmlT m ()
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-353"></span><span>      </span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span id="local-6989586621679269483"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269483"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679269484"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269484"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679269485"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269485"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Text]
</span><a href="#local-6989586621679269475"><span class="hs-identifier hs-var">getClass</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269483"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-356"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;label&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HtmlT m ()
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-357"></span><span>      </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><span class="annottext">[Attribute] -&gt; HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">polyline_</span></span><span> </span><span class="annot"><span class="annottext">([Attribute] -&gt; HtmlT m ()) -&gt; [Attribute] -&gt; HtmlT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">points_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(XY -&gt; String) -&gt; [XY] -&gt; String
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">XY -&gt; String
forall {a} {a}. (Show a, Show a) =&gt; (a, a) -&gt; String
</span><a href="#local-6989586621679269488"><span class="hs-identifier hs-var">toStr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269484"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269485"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Attribute] -&gt; [Attribute]
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269483"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Text]
</span><a href="#local-6989586621679269480"><span class="hs-identifier hs-var">getId</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269483"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679269489"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679269489"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-361"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269490"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269490"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269491"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269491"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269484"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-362"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269492"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269492"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269493"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269493"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679269485"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679269502"><span class="annot"><span class="annottext">n :: Double
</span><a href="#local-6989586621679269502"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269490"><span class="hs-identifier hs-var">x1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269492"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269491"><span class="hs-identifier hs-var">y1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269493"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; XY -&gt; HtmlT m ()
forall a (m :: * -&gt; *).
(ToHtml a, Monad m) =&gt;
a -&gt; XY -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#mkLabel"><span class="hs-identifier hs-var">mkLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679269489"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269492"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269502"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269490"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269492"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269493"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269502"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269491"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269493"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HtmlT m ()
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-366"></span><span> </span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span id="local-6989586621679269505"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269505"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679269506"><span class="annot"><span class="annottext">[XY]
</span><a href="#local-6989586621679269506"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Text]
</span><a href="#local-6989586621679269475"><span class="hs-identifier hs-var">getClass</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269505"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;polygon&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">polygon_</span></span><span> </span><span class="annot"><span class="annottext">([Attribute] -&gt; HtmlT m ()) -&gt; [Attribute] -&gt; HtmlT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">points_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(XY -&gt; String) -&gt; [XY] -&gt; String
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">XY -&gt; String
forall {a} {a}. (Show a, Show a) =&gt; (a, a) -&gt; String
</span><a href="#local-6989586621679269488"><span class="hs-identifier hs-var">toStr</span></a></span><span> </span><span class="annot"><span class="annottext">[XY]
</span><a href="#local-6989586621679269506"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Attribute] -&gt; [Attribute]
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269505"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-371"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;polyline&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-372"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">polyline_</span></span><span> </span><span class="annot"><span class="annottext">([Attribute] -&gt; HtmlT m ()) -&gt; [Attribute] -&gt; HtmlT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">points_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(XY -&gt; String) -&gt; [XY] -&gt; String
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">XY -&gt; String
forall {a} {a}. (Show a, Show a) =&gt; (a, a) -&gt; String
</span><a href="#local-6989586621679269488"><span class="hs-identifier hs-var">toStr</span></a></span><span> </span><span class="annot"><span class="annottext">[XY]
</span><a href="#local-6989586621679269506"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Attribute] -&gt; [Attribute]
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269505"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-373"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;bg&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-374"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">rect_</span></span><span> </span><span class="annot"><span class="annottext">([Attribute] -&gt; HtmlT m ()) -&gt; [Attribute] -&gt; HtmlT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;100%&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">height_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;100%&quot;</span></span><span>
</span><span id="line-375"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;none&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_opacity_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;1&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Attribute] -&gt; [Attribute]
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679269505"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-376"></span><span>      </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HtmlT m ()
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-379"></span><span>    </span><span id="local-6989586621679269488"><span class="annot"><span class="annottext">toStr :: (a, a) -&gt; String
</span><a href="#local-6989586621679269488"><span class="hs-identifier hs-var hs-var">toStr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269524"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269524"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679269525"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269525"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269524"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269525"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-380"></span><span>    </span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621679269480"><span class="annot"><span class="annottext">getId :: [Attribute] -&gt; [Text]
</span><a href="#local-6989586621679269480"><span class="hs-identifier hs-var hs-var">getId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Attribute -&gt; Maybe Text) -&gt; [Attribute] -&gt; [Text]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">((Attribute -&gt; Maybe Text) -&gt; [Attribute] -&gt; [Text])
-&gt; (Attribute -&gt; Maybe Text) -&gt; [Attribute] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-382"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;id&quot;</span></span><span> </span><span id="local-6989586621679269528"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679269528"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679269528"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-383"></span><span>      </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span>    </span><span id="local-6989586621679269475"><span class="annot"><span class="annottext">getClass :: [Attribute] -&gt; [Text]
</span><a href="#local-6989586621679269475"><span class="hs-identifier hs-var hs-var">getClass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Attribute -&gt; Maybe Text) -&gt; [Attribute] -&gt; [Text]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">((Attribute -&gt; Maybe Text) -&gt; [Attribute] -&gt; [Text])
-&gt; (Attribute -&gt; Maybe Text) -&gt; [Attribute] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;class&quot;</span></span><span> </span><span id="local-6989586621679269531"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679269531"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679269531"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-387"></span><span>      </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span id="local-6989586621679268539"><span id="local-6989586621679268540"><span class="annot"><a href="Algeometry.SVG.html#mkLabel"><span class="hs-identifier hs-type">mkLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToHtml</span></span><span> </span><span class="annot"><a href="#local-6989586621679268539"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679268540"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679268539"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-type">XY</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HtmlT</span></span><span> </span><span class="annot"><a href="#local-6989586621679268540"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-390"></span><span id="mkLabel"><span class="annot"><span class="annottext">mkLabel :: forall a (m :: * -&gt; *).
(ToHtml a, Monad m) =&gt;
a -&gt; XY -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#mkLabel"><span class="hs-identifier hs-var hs-var">mkLabel</span></a></span></span><span> </span><span id="local-6989586621679269562"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269562"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269563"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269563"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269564"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269564"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-391"></span><span>  </span><span class="annot"><span class="annottext">[Attribute] -&gt; HtmlT m () -&gt; HtmlT m ()
forall arg result. Term arg result =&gt; arg -&gt; result
</span><span class="hs-identifier hs-var">text_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">x_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Text
forall a. RealFloat a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269563"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">y_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Text
forall a. RealFloat a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269564"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;white&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;white&quot;</span></span><span>
</span><span id="line-394"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;5&quot;</span></span><span>
</span><span id="line-395"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
forall arg result. Term arg result =&gt; arg -&gt; result
</span><span class="hs-identifier hs-var">filter_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;url(#blur1)&quot;</span></span><span>
</span><span id="line-396"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">text_anchor_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;middle&quot;</span></span><span>
</span><span id="line-397"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">opacity_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(HtmlT m () -&gt; HtmlT m ()) -&gt; HtmlT m () -&gt; HtmlT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; HtmlT m ()
forall a (m :: * -&gt; *). (ToHtml a, Monad m) =&gt; a -&gt; HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; a -&gt; HtmlT m ()
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269562"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><span class="annottext">[Attribute] -&gt; HtmlT m () -&gt; HtmlT m ()
forall arg result. Term arg result =&gt; arg -&gt; result
</span><span class="hs-identifier hs-var">text_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">x_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Text
forall a. RealFloat a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269563"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">y_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Text
forall a. RealFloat a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269564"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;none&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;black&quot;</span></span><span>
</span><span id="line-401"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">text_anchor_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;middle&quot;</span></span><span>
</span><span id="line-402"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">opacity_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(HtmlT m () -&gt; HtmlT m ()) -&gt; HtmlT m () -&gt; HtmlT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; HtmlT m ()
forall a (m :: * -&gt; *). (ToHtml a, Monad m) =&gt; a -&gt; HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; a -&gt; HtmlT m ()
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679269562"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="annot"><span class="hs-comment">-- | Returns raw SVG for a figure.</span></span><span>
</span><span id="line-405"></span><span id="local-6989586621679268556"><span class="annot"><a href="Algeometry.SVG.html#svg"><span class="hs-identifier hs-type">svg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679268556"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-type">Fig</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HtmlT</span></span><span> </span><span class="annot"><a href="#local-6989586621679268556"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-406"></span><span id="svg"><span class="annot"><span class="annottext">svg :: forall (m :: * -&gt; *). Monad m =&gt; [Fig] -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#svg"><span class="hs-identifier hs-var hs-var">svg</span></a></span></span><span> </span><span id="local-6989586621679269591"><span class="annot"><span class="annottext">[Fig]
</span><a href="#local-6989586621679269591"><span class="hs-identifier hs-var">fig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-407"></span><span>  </span><span class="annot"><span class="annottext">HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; SvgT m ()
</span><span class="hs-identifier hs-var">doctype_</span></span><span>
</span><span id="line-408"></span><span>  </span><span class="annot"><span class="annottext">HtmlT m () -&gt; [Attribute] -&gt; HtmlT m ()
forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-identifier hs-var">with</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HtmlT m () -&gt; HtmlT m ()
forall s t. Term [Attribute] (s -&gt; t) =&gt; s -&gt; t
</span><span class="hs-identifier hs-var">svg11_</span></span><span> </span><span class="annot"><span class="annottext">HtmlT m ()
</span><a href="#local-6989586621679269594"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;400&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">height_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;400&quot;</span></span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;black&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;none&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_opacity_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;0.75&quot;</span></span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">font_size_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;14&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">font_style_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;italic&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">font_family_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;sans-serif&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621679269594"><span class="annot"><span class="annottext">content :: HtmlT m ()
</span><a href="#local-6989586621679269594"><span class="hs-identifier hs-var hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-414"></span><span>      </span><span class="annot"><span class="annottext">[Attribute] -&gt; HtmlT m () -&gt; HtmlT m ()
forall arg result. Term arg result =&gt; arg -&gt; result
</span><span class="hs-identifier hs-var">filter_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">id_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;blur1&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(HtmlT m () -&gt; HtmlT m ()) -&gt; HtmlT m () -&gt; HtmlT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">feGaussianBlur_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stdDeviation_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;0.5&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-415"></span><span>      </span><span class="annot"><span class="annottext">[Attribute] -&gt; HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">rect_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;100%&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">height_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;100%&quot;</span></span><span>
</span><span id="line-416"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;white&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;none&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_opacity_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;1&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span>      </span><span class="annot"><span class="annottext">(Fig -&gt; HtmlT m ()) -&gt; [Fig] -&gt; HtmlT m ()
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fig -&gt; HtmlT m ()
forall (m :: * -&gt; *). Monad m =&gt; Fig -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#renderFig"><span class="hs-identifier hs-var">renderFig</span></a></span><span> </span><span class="annot"><span class="annottext">(Fig -&gt; HtmlT m ()) -&gt; (Fig -&gt; Fig) -&gt; Fig -&gt; HtmlT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XY -&gt; Fig -&gt; Fig
</span><a href="Algeometry.SVG.html#rescaleTo"><span class="hs-identifier hs-var">rescaleTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">400</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">400</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Fig] -&gt; HtmlT m ()) -&gt; [Fig] -&gt; HtmlT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Fig] -&gt; [Fig]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">[Fig]
</span><a href="#local-6989586621679269591"><span class="hs-identifier hs-var">fig</span></a></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="annot"><span class="hs-comment">-- | Outputs figure to SVG file.</span></span><span>
</span><span id="line-420"></span><span id="local-6989586621679268564"><span class="annot"><a href="Algeometry.SVG.html#writeSVG"><span class="hs-identifier hs-type">writeSVG</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268564"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-421"></span><span id="writeSVG"><span class="annot"><span class="annottext">writeSVG :: forall b. String -&gt; Figure PGA2 b -&gt; IO ()
</span><a href="Algeometry.SVG.html#writeSVG"><span class="hs-identifier hs-var hs-var">writeSVG</span></a></span></span><span> </span><span id="local-6989586621679269632"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269632"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span id="local-6989586621679269633"><span class="annot"><span class="annottext">Figure PGA2 b
</span><a href="#local-6989586621679269633"><span class="hs-identifier hs-var">figs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>  </span><span id="local-6989586621679269634"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269634"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><span class="hs-identifier hs-var">openFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269632"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; HtmlT Identity () -&gt; IO ()
forall a. Show a =&gt; Handle -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">hPrint</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269634"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Fig] -&gt; HtmlT Identity ()
forall (m :: * -&gt; *). Monad m =&gt; [Fig] -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#svg"><span class="hs-identifier hs-var">svg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Figure PGA2 b -&gt; [Fig]
forall b. Figure PGA2 b -&gt; [Fig]
</span><a href="Algeometry.SVG.html#figure"><span class="hs-identifier hs-var">figure</span></a></span><span> </span><span class="annot"><span class="annottext">Figure PGA2 b
</span><a href="#local-6989586621679269633"><span class="hs-identifier hs-var">figs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269634"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="annot"><span class="hs-comment">-- | Outputs figure to PNG file.</span></span><span>
</span><span id="line-427"></span><span id="local-6989586621679269639"><span class="annot"><a href="Algeometry.SVG.html#writePNG"><span class="hs-identifier hs-type">writePNG</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679269639"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-428"></span><span id="writePNG"><span class="annot"><span class="annottext">writePNG :: forall b. String -&gt; Figure PGA2 b -&gt; IO ()
</span><a href="Algeometry.SVG.html#writePNG"><span class="hs-identifier hs-var hs-var">writePNG</span></a></span></span><span> </span><span id="local-6989586621679269652"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269652"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span id="local-6989586621679269653"><span class="annot"><span class="annottext">Figure PGA2 b
</span><a href="#local-6989586621679269653"><span class="hs-identifier hs-var">figs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679269657"><span class="annot"><span class="annottext">svgFile :: String
</span><a href="#local-6989586621679269657"><span class="hs-identifier hs-var hs-var">svgFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269652"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.svg&quot;</span></span><span>
</span><span id="line-430"></span><span>      </span><span id="local-6989586621679269661"><span class="annot"><span class="annottext">pngFile :: String
</span><a href="#local-6989586621679269661"><span class="hs-identifier hs-var hs-var">pngFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269652"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.png&quot;</span></span><span>
</span><span id="line-431"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Figure PGA2 b -&gt; IO ()
forall b. String -&gt; Figure PGA2 b -&gt; IO ()
</span><a href="Algeometry.SVG.html#writeSVG"><span class="hs-identifier hs-var">writeSVG</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269657"><span class="hs-identifier hs-var">svgFile</span></a></span><span> </span><span class="annot"><span class="annottext">Figure PGA2 b
</span><a href="#local-6989586621679269653"><span class="hs-identifier hs-var">figs</span></a></span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679269665"><span class="annot"><span class="annottext">opts :: [String]
</span><a href="#local-6989586621679269665"><span class="hs-identifier hs-var hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-density&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;150&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269657"><span class="hs-identifier hs-var">svgFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269661"><span class="hs-identifier hs-var">pngFile</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679269666"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269666"><span class="hs-identifier hs-var">hout</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CreateProcess
-&gt; IO (Maybe Handle, Maybe Handle, Maybe Handle, ProcessHandle)
</span><span class="hs-identifier hs-var">createProcess</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; CreateProcess
</span><span class="hs-identifier hs-var">proc</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;convert&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679269665"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">std_out :: StdStream
</span><span class="hs-identifier hs-var">std_out</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdStream
</span><span class="hs-identifier hs-var">CreatePipe</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-434"></span><span>  </span><span id="local-6989586621679269671"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269671"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><span class="hs-identifier hs-var">hGetContents</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269666"><span class="hs-identifier hs-var">hout</span></a></span><span>
</span><span id="line-435"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269671"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269661"><span class="hs-identifier hs-var">pngFile</span></a></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="annot"><span class="hs-comment">-- | Type representing animationa frames. </span></span><span>
</span><span id="line-441"></span><span class="hs-keyword">newtype</span><span> </span><span id="Animation"><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-var">Animation</span></a></span></span><span> </span><span id="local-6989586621679268611"><span class="annot"><a href="#local-6989586621679268611"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Animation"><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-var">Animation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-type">Fig</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679268611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269677"><span id="local-6989586621679269682"><span id="local-6989586621679269686"><span class="annot"><span class="annottext">Int -&gt; Animation a -&gt; ShowS
[Animation a] -&gt; ShowS
Animation a -&gt; String
(Int -&gt; Animation a -&gt; ShowS)
-&gt; (Animation a -&gt; String)
-&gt; ([Animation a] -&gt; ShowS)
-&gt; Show (Animation a)
forall a. Show a =&gt; Int -&gt; Animation a -&gt; ShowS
forall a. Show a =&gt; [Animation a] -&gt; ShowS
forall a. Show a =&gt; Animation a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Animation a -&gt; ShowS
showsPrec :: Int -&gt; Animation a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Animation a -&gt; String
show :: Animation a -&gt; String
$cshowList :: forall a. Show a =&gt; [Animation a] -&gt; ShowS
showList :: [Animation a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269691"><span id="local-6989586621679269695"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Animation a -&gt; Animation b)
-&gt; (forall a b. a -&gt; Animation b -&gt; Animation a)
-&gt; Functor Animation
forall a b. a -&gt; Animation b -&gt; Animation a
forall a b. (a -&gt; b) -&gt; Animation a -&gt; Animation b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Animation a -&gt; Animation b
fmap :: forall a b. (a -&gt; b) -&gt; Animation a -&gt; Animation b
$c&lt;$ :: forall a b. a -&gt; Animation b -&gt; Animation a
&lt;$ :: forall a b. a -&gt; Animation b -&gt; Animation a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269702"><span id="local-6989586621679269707"><span id="local-6989586621679269712"><span id="local-6989586621679269717"><span id="local-6989586621679269722"><span class="annot"><span class="annottext">Functor Animation
Functor Animation
-&gt; (forall a. a -&gt; Animation a)
-&gt; (forall a b. Animation (a -&gt; b) -&gt; Animation a -&gt; Animation b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; Animation a -&gt; Animation b -&gt; Animation c)
-&gt; (forall a b. Animation a -&gt; Animation b -&gt; Animation b)
-&gt; (forall a b. Animation a -&gt; Animation b -&gt; Animation a)
-&gt; Applicative Animation
forall a. a -&gt; Animation a
forall a b. Animation a -&gt; Animation b -&gt; Animation a
forall a b. Animation a -&gt; Animation b -&gt; Animation b
forall a b. Animation (a -&gt; b) -&gt; Animation a -&gt; Animation b
forall a b c.
(a -&gt; b -&gt; c) -&gt; Animation a -&gt; Animation b -&gt; Animation c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall a. a -&gt; Animation a
pure :: forall a. a -&gt; Animation a
$c&lt;*&gt; :: forall a b. Animation (a -&gt; b) -&gt; Animation a -&gt; Animation b
&lt;*&gt; :: forall a b. Animation (a -&gt; b) -&gt; Animation a -&gt; Animation b
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Animation a -&gt; Animation b -&gt; Animation c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Animation a -&gt; Animation b -&gt; Animation c
$c*&gt; :: forall a b. Animation a -&gt; Animation b -&gt; Animation b
*&gt; :: forall a b. Animation a -&gt; Animation b -&gt; Animation b
$c&lt;* :: forall a b. Animation a -&gt; Animation b -&gt; Animation a
&lt;* :: forall a b. Animation a -&gt; Animation b -&gt; Animation a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269730"><span id="local-6989586621679269735"><span id="local-6989586621679269740"><span class="annot"><span class="annottext">Applicative Animation
Applicative Animation
-&gt; (forall a b. Animation a -&gt; (a -&gt; Animation b) -&gt; Animation b)
-&gt; (forall a b. Animation a -&gt; Animation b -&gt; Animation b)
-&gt; (forall a. a -&gt; Animation a)
-&gt; Monad Animation
forall a. a -&gt; Animation a
forall a b. Animation a -&gt; Animation b -&gt; Animation b
forall a b. Animation a -&gt; (a -&gt; Animation b) -&gt; Animation b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall a b. Animation a -&gt; (a -&gt; Animation b) -&gt; Animation b
&gt;&gt;= :: forall a b. Animation a -&gt; (a -&gt; Animation b) -&gt; Animation b
$c&gt;&gt; :: forall a b. Animation a -&gt; Animation b -&gt; Animation b
&gt;&gt; :: forall a b. Animation a -&gt; Animation b -&gt; Animation b
$creturn :: forall a. a -&gt; Animation a
return :: forall a. a -&gt; Animation a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="annot"><span class="hs-comment">-- | Outputs single frame of animation, given by a frame number. </span></span><span>
</span><span id="line-445"></span><span id="writeFrame"><span class="annot"><span class="annottext">writeFrame :: Int -&gt; String -&gt; Animation a -&gt; IO ()
</span><a href="Algeometry.SVG.html#writeFrame"><span class="hs-identifier hs-var hs-var">writeFrame</span></a></span></span><span> </span><span id="local-6989586621679269755"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679269755"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679269756"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269756"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269757"><span class="annot"><span class="annottext">[[Fig]]
</span><a href="#local-6989586621679269757"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679269758"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269758"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><span class="hs-identifier hs-var">openFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269756"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span>
</span><span id="line-447"></span><span>     </span><span class="annot"><span class="annottext">Handle -&gt; HtmlT Identity () -&gt; IO ()
forall a. Show a =&gt; Handle -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">hPrint</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269758"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Fig] -&gt; HtmlT Identity ()
forall (m :: * -&gt; *). Monad m =&gt; [Fig] -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#svg"><span class="hs-identifier hs-var">svg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Fig]]
</span><a href="#local-6989586621679269757"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">[[Fig]] -&gt; Int -&gt; [Fig]
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679269755"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>     </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269758"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-449"></span><span>     </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269756"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="annot"><span class="hs-comment">-- | Outputs  animation as GIF file, using `convert` utility.</span></span><span>
</span><span id="line-452"></span><span id="local-6989586621679268604"><span class="annot"><a href="Algeometry.SVG.html#runAnimation"><span class="hs-identifier hs-type">runAnimation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268604"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-453"></span><span id="runAnimation"><span class="annot"><span class="annottext">runAnimation :: forall a. String -&gt; Animation a -&gt; IO ()
</span><a href="Algeometry.SVG.html#runAnimation"><span class="hs-identifier hs-var hs-var">runAnimation</span></a></span></span><span> </span><span id="local-6989586621679269787"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269787"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269788"><span class="annot"><span class="annottext">[[Fig]]
</span><a href="#local-6989586621679269788"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;producing SVG..&quot;</span></span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><span class="annottext">(([Fig], Integer) -&gt; IO ()) -&gt; [([Fig], Integer)] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">([Fig], Integer) -&gt; IO ()
forall {b}. Show b =&gt; ([Fig], b) -&gt; IO ()
</span><a href="#local-6989586621679269789"><span class="hs-identifier hs-var">mkSVG</span></a></span><span> </span><span class="annot"><span class="annottext">([([Fig], Integer)] -&gt; IO ()) -&gt; [([Fig], Integer)] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Fig]] -&gt; [Integer] -&gt; [([Fig], Integer)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[[Fig]]
</span><a href="#local-6989586621679269788"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;converting to GIF..&quot;</span></span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679269796"><span class="annot"><span class="annottext">opts :: [String]
</span><a href="#local-6989586621679269796"><span class="hs-identifier hs-var hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-delay&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-loop&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;figs/an/*.svg&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269787"><span class="hs-identifier hs-var">fname</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679269797"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269797"><span class="hs-identifier hs-var">hout1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CreateProcess
-&gt; IO (Maybe Handle, Maybe Handle, Maybe Handle, ProcessHandle)
</span><span class="hs-identifier hs-var">createProcess</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; CreateProcess
</span><span class="hs-identifier hs-var">proc</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;convert&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679269796"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">std_out :: StdStream
</span><span class="hs-identifier hs-var">std_out</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdStream
</span><span class="hs-identifier hs-var">CreatePipe</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-459"></span><span>  </span><span id="local-6989586621679269798"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269798"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><span class="hs-identifier hs-var">hGetContents</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269797"><span class="hs-identifier hs-var">hout1</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269798"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269787"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-462"></span><span>  </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>    </span><span id="local-6989586621679269789"><span class="annot"><span class="annottext">mkSVG :: ([Fig], b) -&gt; IO ()
</span><a href="#local-6989586621679269789"><span class="hs-identifier hs-var hs-var">mkSVG</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269808"><span class="annot"><span class="annottext">[Fig]
</span><a href="#local-6989586621679269808"><span class="hs-identifier hs-var">fr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269809"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679269809"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-465"></span><span>      </span><span id="local-6989586621679269811"><span class="annot"><span class="annottext">si :: String
</span><a href="#local-6989586621679269811"><span class="hs-identifier hs-var hs-var">si</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679269809"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-466"></span><span>      </span><span id="local-6989586621679269817"><span class="annot"><span class="annottext">fnum :: String
</span><a href="#local-6989586621679269817"><span class="hs-identifier hs-var hs-var">fnum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269811"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269811"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-467"></span><span>      </span><span id="local-6989586621679269825"><span class="annot"><span class="annottext">fname :: String
</span><a href="#local-6989586621679269825"><span class="hs-identifier hs-var hs-var">fname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;figs/an/p&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269817"><span class="hs-identifier hs-var">fnum</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.svg&quot;</span></span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679269826"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269826"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><span class="hs-identifier hs-var">openFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269825"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span>
</span><span id="line-469"></span><span>            </span><span class="annot"><span class="annottext">Handle -&gt; HtmlT Identity () -&gt; IO ()
forall a. Show a =&gt; Handle -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">hPrint</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269826"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Fig] -&gt; HtmlT Identity ()
forall (m :: * -&gt; *). Monad m =&gt; [Fig] -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#svg"><span class="hs-identifier hs-var">svg</span></a></span><span> </span><span class="annot"><span class="annottext">[Fig]
</span><a href="#local-6989586621679269808"><span class="hs-identifier hs-var">fr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>            </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679269826"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-471"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679269825"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="annot"><span class="hs-comment">-- | Creates animation from a list of figures.</span></span><span>
</span><span id="line-474"></span><span id="local-6989586621679268609"><span class="annot"><a href="Algeometry.SVG.html#animateList"><span class="hs-identifier hs-type">animateList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268609"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-475"></span><span id="animateList"><span class="annot"><span class="annottext">animateList :: forall a. [Figure PGA2 a] -&gt; Animation ()
</span><a href="Algeometry.SVG.html#animateList"><span class="hs-identifier hs-var hs-var">animateList</span></a></span></span><span> </span><span id="local-6989586621679269828"><span class="annot"><span class="annottext">[Figure PGA2 a]
</span><a href="#local-6989586621679269828"><span class="hs-identifier hs-var">frs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[Fig]], ()) -&gt; Animation ()
forall a. ([[Fig]], a) -&gt; Animation a
</span><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-var">Animation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Figure PGA2 a -&gt; [Fig]
forall b. Figure PGA2 b -&gt; [Fig]
</span><a href="Algeometry.SVG.html#figure"><span class="hs-identifier hs-var">figure</span></a></span><span> </span><span class="annot"><span class="annottext">(Figure PGA2 a -&gt; [Fig]) -&gt; [Figure PGA2 a] -&gt; [[Fig]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Figure PGA2 a]
</span><a href="#local-6989586621679269828"><span class="hs-identifier hs-var">frs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="annot"><span class="hs-comment">-- | Creates animation from a parameterized  function and given nuber of frames.</span></span><span>
</span><span id="line-478"></span><span id="local-6989586621679268612"><span class="annot"><a href="Algeometry.SVG.html#animate"><span class="hs-identifier hs-type">animate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268612"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-479"></span><span id="animate"><span class="annot"><span class="annottext">animate :: forall a. Int -&gt; XY -&gt; (Double -&gt; Figure PGA2 a) -&gt; Animation ()
</span><a href="Algeometry.SVG.html#animate"><span class="hs-identifier hs-var hs-var">animate</span></a></span></span><span> </span><span id="local-6989586621679269831"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679269831"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679269832"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269832"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679269833"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269833"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679269834"><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679269834"><span class="hs-identifier hs-var">mkFrame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Animation ()) -&gt; [Double] -&gt; Animation ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Animation ()
</span><a href="#local-6989586621679269835"><span class="hs-identifier hs-var">frame</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679269836"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-481"></span><span>    </span><span id="local-6989586621679269836"><span class="annot"><span class="annottext">ts :: [Double]
</span><a href="#local-6989586621679269836"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269832"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679269851"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269833"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269832"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679269831"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679269851"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679269851"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679269831"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-483"></span><span>    </span><span id="local-6989586621679269835"><span class="annot"><span class="annottext">frame :: Double -&gt; Animation ()
</span><a href="#local-6989586621679269835"><span class="hs-identifier hs-var hs-var">frame</span></a></span></span><span> </span><span id="local-6989586621679269852"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269852"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[Fig]], ()) -&gt; Animation ()
forall a. ([[Fig]], a) -&gt; Animation a
</span><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-var">Animation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Figure PGA2 a -&gt; [Fig]
forall b. Figure PGA2 b -&gt; [Fig]
</span><a href="Algeometry.SVG.html#figure"><span class="hs-identifier hs-var">figure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679269834"><span class="hs-identifier hs-var">mkFrame</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269852"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="annot"><span class="hs-comment">-- | Creates animation with nonlinear paremeterization.</span></span><span>
</span><span id="line-486"></span><span id="local-6989586621679268616"><span class="annot"><a href="Algeometry.SVG.html#transform"><span class="hs-identifier hs-type">transform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679268616"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-487"></span><span id="transform"><span class="annot"><span class="annottext">transform :: forall a. Int -&gt; (Double -&gt; Figure PGA2 a) -&gt; Animation ()
</span><a href="Algeometry.SVG.html#transform"><span class="hs-identifier hs-var hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679269853"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679269853"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679269854"><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679269854"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; XY -&gt; (Double -&gt; Figure PGA2 a) -&gt; Animation ()
forall a. Int -&gt; XY -&gt; (Double -&gt; Figure PGA2 a) -&gt; Animation ()
</span><a href="Algeometry.SVG.html#animate"><span class="hs-identifier hs-var">animate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679269853"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679269855"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621679269855"><span class="annot"><span class="annottext">go :: Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679269855"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679269866"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269866"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679269854"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Figure PGA2 a) -&gt; Double -&gt; Figure PGA2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">exp</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679269866"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span></pre></body></html>