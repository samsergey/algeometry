<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Algeometry.SVG
Description : Quick and dirty graphic backend for geometric algebra.
Stability   : experimental
-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances
, LambdaCase
, DerivingVia
, StandaloneDeriving
, DataKinds
, KindSignatures
, GeneralizedNewtypeDeriving
, MultiParamTypeClasses
, FlexibleInstances
, OverloadedStrings
, FunctionalDependencies
, BangPatterns #-}</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algeometry.SVG</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier">Fig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier">Figure</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#figure"><span class="hs-identifier">figure</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#getFigure"><span class="hs-identifier">getFigure</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#getResult"><span class="hs-identifier">getResult</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#mapFig"><span class="hs-identifier">mapFig</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier">Animation</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- * SVG generation and output</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#put"><span class="hs-identifier">put</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#%40"><span class="hs-operator">(@)</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#%3C%40"><span class="hs-operator">(&lt;@)</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#svg"><span class="hs-identifier">svg</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#writeSVG"><span class="hs-identifier">writeSVG</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#writePNG"><span class="hs-identifier">writePNG</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Simple animation</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#writeFrame"><span class="hs-identifier">writeFrame</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#runAnimation"><span class="hs-identifier">runAnimation</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#animate"><span class="hs-identifier">animate</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#transform"><span class="hs-identifier">transform</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#animateList"><span class="hs-identifier">animateList</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Constructors</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#origin"><span class="hs-identifier">origin</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier">point</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#line"><span class="hs-identifier">line</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#nline"><span class="hs-identifier">nline</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#vect"><span class="hs-identifier">vect</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#nvect"><span class="hs-identifier">nvect</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#segm"><span class="hs-identifier">segm</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier">polygon</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#polyline"><span class="hs-identifier">polyline</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#regularPoly"><span class="hs-identifier">regularPoly</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#segment"><span class="hs-identifier">segment</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#plane"><span class="hs-identifier">plane</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#plane2"><span class="hs-identifier">plane2</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#plane3"><span class="hs-identifier">plane3</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#orthoPlane"><span class="hs-identifier">orthoPlane</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#label"><span class="hs-keyword">label</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#display"><span class="hs-identifier">display</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Miscellaneous tools</span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#viewPoint"><span class="hs-identifier">viewPoint</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#axis"><span class="hs-identifier">axis</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#grid"><span class="hs-identifier">grid</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#background"><span class="hs-identifier">background</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algeometry.html"><span class="hs-identifier">Algeometry</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">union</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lucid.Base</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HtmlT</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lucid.Svg</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">scale</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Term</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Process</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">With</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679260527"><span class="annot"><span class="annottext">with :: [Attribute] -&gt; [Attribute] -&gt; [Attribute]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">with</span></span></span><span> </span><span id="local-6989586621679260525"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260525"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679260524"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260524"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; Attribute -&gt; [Attribute]
</span><a href="#local-6989586621679260522"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260525"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260524"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>      </span><span id="local-6989586621679260522"><span class="annot"><span class="annottext">add :: [Attribute] -&gt; Attribute -&gt; [Attribute]
</span><a href="#local-6989586621679260522"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621679260519"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260519"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621679260518"><span class="annot"><span class="annottext">att :: Attribute
</span><a href="#local-6989586621679260518"><span class="hs-identifier hs-var">att</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span> </span><span id="local-6989586621679260516"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679260516"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260515"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679260515"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260519"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span> </span><span id="local-6989586621679260514"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679260514"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679260513"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260513"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679260516"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679260514"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679260518"><span class="hs-identifier hs-var">att</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260513"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span id="local-6989586621679260512"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260512"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679260518"><span class="hs-identifier hs-var">att</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260512"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-keyword">type</span><span> </span><span id="XY"><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-var">XY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- | Represents graphic primitives</span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="Fig"><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-var">Fig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Point"><span class="annot"><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-var">Point</span></a></span></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-type">XY</span></a></span><span>
</span><span id="line-96"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span id="Line"><span class="annot"><a href="Algeometry.SVG.html#Line"><span class="hs-identifier hs-var">Line</span></a></span></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-type">XY</span></a></span><span> </span><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-type">XY</span></a></span><span>
</span><span id="line-97"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span id="Polygon"><span class="annot"><a href="Algeometry.SVG.html#Polygon"><span class="hs-identifier hs-var">Polygon</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-type">XY</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260487"><span id="local-6989586621679260489"><span id="local-6989586621679260507"><span class="annot"><span class="annottext">Int -&gt; Fig -&gt; ShowS
[Fig] -&gt; ShowS
Fig -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Fig] -&gt; ShowS
$cshowList :: [Fig] -&gt; ShowS
show :: Fig -&gt; String
$cshow :: Fig -&gt; String
showsPrec :: Int -&gt; Fig -&gt; ShowS
$cshowsPrec :: Int -&gt; Fig -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260468"><span id="local-6989586621679260482"><span class="annot"><span class="annottext">Fig -&gt; Fig -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Fig -&gt; Fig -&gt; Bool
$c/= :: Fig -&gt; Fig -&gt; Bool
== :: Fig -&gt; Fig -&gt; Bool
$c== :: Fig -&gt; Fig -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679260450"><span id="local-6989586621679260452"><span id="local-6989586621679260454"><span id="local-6989586621679260456"><span id="local-6989586621679260458"><span id="local-6989586621679260460"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-type">Fig</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621679260448"><span class="annot"><span class="annottext">compare :: Fig -&gt; Fig -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">XY
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Fig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Fig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">XY
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Fig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Fig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Algeometry.SVG.html#clip"><span class="hs-identifier hs-type">clip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span id="clip"><span class="annot"><span class="annottext">clip :: PGA2 -&gt; [PGA2]
</span><a href="Algeometry.SVG.html#clip"><span class="hs-identifier hs-var hs-var">clip</span></a></span></span><span> </span><span id="local-6989586621679260445"><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679260445"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679260429"><span class="annot"><span class="annottext">vs :: [PGA2]
</span><a href="#local-6989586621679260429"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679260427"><span class="annot"><span class="annottext">frame :: [(PGA2, PGA2)]
</span><a href="#local-6989586621679260427"><span class="hs-identifier hs-var hs-var">frame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679260429"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679260429"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; (mv, mv) -&gt; Maybe mv
</span><a href="Algeometry.GeometricAlgebra.html#segmentMeet"><span class="hs-identifier hs-var">segmentMeet</span></a></span><span> </span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679260445"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(PGA2, PGA2)]
</span><a href="#local-6989586621679260427"><span class="hs-identifier hs-var">frame</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | Representation of a figure with many graphic objects with attributes.</span><span>
</span><span id="line-116"></span><span class="hs-keyword">newtype</span><span> </span><span id="Figure"><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span></span><span> </span><span id="local-6989586621679260903"><span class="annot"><a href="#local-6989586621679260903"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679260874"><span class="annot"><a href="#local-6989586621679260874"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Figure"><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260903"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679260874"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260414"><span id="local-6989586621679260416"><span id="local-6989586621679260421"><span class="annot"><span class="annottext">Int -&gt; Figure a b -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall a b. (Show a, Show b) =&gt; Int -&gt; Figure a b -&gt; ShowS
forall a b. (Show a, Show b) =&gt; [Figure a b] -&gt; ShowS
forall a b. (Show a, Show b) =&gt; Figure a b -&gt; String
showList :: [Figure a b] -&gt; ShowS
$cshowList :: forall a b. (Show a, Show b) =&gt; [Figure a b] -&gt; ShowS
show :: Figure a b -&gt; String
$cshow :: forall a b. (Show a, Show b) =&gt; Figure a b -&gt; String
showsPrec :: Int -&gt; Figure a b -&gt; ShowS
$cshowsPrec :: forall a b. (Show a, Show b) =&gt; Int -&gt; Figure a b -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260403"><span id="local-6989586621679260408"><span class="annot"><span class="annottext">forall a b. a -&gt; Figure a b -&gt; Figure a a
forall a b. (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
forall a a b. a -&gt; Figure a b -&gt; Figure a a
forall a a b. (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; Figure a b -&gt; Figure a a
$c&lt;$ :: forall a a b. a -&gt; Figure a b -&gt; Figure a a
fmap :: forall a b. (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
$cfmap :: forall a a b. (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260374"><span id="local-6989586621679260379"><span id="local-6989586621679260384"><span id="local-6989586621679260389"><span id="local-6989586621679260395"><span class="annot"><span class="annottext">forall a. Functor (Figure a)
forall a. a -&gt; Figure a a
forall a a. a -&gt; Figure a a
forall a b. Figure a a -&gt; Figure a b -&gt; Figure a a
forall a b. Figure a a -&gt; Figure a b -&gt; Figure a b
forall a b. Figure a (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a a
forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a b
forall a a b. Figure a (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
forall a b c.
(a -&gt; b -&gt; c) -&gt; Figure a a -&gt; Figure a b -&gt; Figure a c
forall a a b c.
(a -&gt; b -&gt; c) -&gt; Figure a a -&gt; Figure a b -&gt; Figure a c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: forall a b. Figure a a -&gt; Figure a b -&gt; Figure a a
$c&lt;* :: forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a a
*&gt; :: forall a b. Figure a a -&gt; Figure a b -&gt; Figure a b
$c*&gt; :: forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a b
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Figure a a -&gt; Figure a b -&gt; Figure a c
$cliftA2 :: forall a a b c.
(a -&gt; b -&gt; c) -&gt; Figure a a -&gt; Figure a b -&gt; Figure a c
&lt;*&gt; :: forall a b. Figure a (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
$c&lt;*&gt; :: forall a a b. Figure a (a -&gt; b) -&gt; Figure a a -&gt; Figure a b
pure :: forall a. a -&gt; Figure a a
$cpure :: forall a a. a -&gt; Figure a a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260353"><span id="local-6989586621679260358"><span id="local-6989586621679260364"><span class="annot"><span class="annottext">forall a. Applicative (Figure a)
forall a. a -&gt; Figure a a
forall a a. a -&gt; Figure a a
forall a b. Figure a a -&gt; Figure a b -&gt; Figure a b
forall a b. Figure a a -&gt; (a -&gt; Figure a b) -&gt; Figure a b
forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a b
forall a a b. Figure a a -&gt; (a -&gt; Figure a b) -&gt; Figure a b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: forall a. a -&gt; Figure a a
$creturn :: forall a a. a -&gt; Figure a a
&gt;&gt; :: forall a b. Figure a a -&gt; Figure a b -&gt; Figure a b
$c&gt;&gt; :: forall a a b. Figure a a -&gt; Figure a b -&gt; Figure a b
&gt;&gt;= :: forall a b. Figure a a -&gt; (a -&gt; Figure a b) -&gt; Figure a b
$c&gt;&gt;= :: forall a a b. Figure a a -&gt; (a -&gt; Figure a b) -&gt; Figure a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679260344"><span id="local-6989586621679260346"><span id="local-6989586621679260822"><span id="local-6989586621679260823"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679260823"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260823"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260822"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679260338"><span class="annot"><span class="annottext">[([a], [Attribute])]
</span><a href="#local-6989586621679260338"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260337"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679260337"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679260336"><span class="annot"><span class="annottext">&lt;&gt; :: Figure a b -&gt; Figure a b -&gt; Figure a b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679260335"><span class="annot"><span class="annottext">[([a], [Attribute])]
</span><a href="#local-6989586621679260335"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[([a], [Attribute])]
</span><a href="#local-6989586621679260338"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">[([a], [Attribute])]
</span><a href="#local-6989586621679260335"><span class="hs-identifier hs-var">f2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679260337"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679260328"><span id="local-6989586621679260330"><span id="local-6989586621679260818"><span id="local-6989586621679260819"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679260819"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260819"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260818"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679260323"><span class="annot"><span class="annottext">mempty :: Figure a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679260811"><span id="local-6989586621679260812"><span class="annot"><span class="hs-identifier hs-type">With</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260812"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260811"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679260318"><span class="annot"><span class="annottext">with :: Figure a b -&gt; [Attribute] -&gt; Figure a b
</span><a href="#local-6989586621679260318"><span class="hs-identifier hs-var hs-var hs-var hs-var">with</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679260317"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260317"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260316"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260316"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260315"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679260315"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679260314"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260314"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="annottext">forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260317"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260316"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260314"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679260315"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>    </span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Returns list of graphic objects with attributes.</span><span>
</span><span id="line-130"></span><span id="local-6989586621679260809"><span id="local-6989586621679260810"><span class="annot"><a href="Algeometry.SVG.html#getFigure"><span class="hs-identifier hs-type">getFigure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260810"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260809"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260810"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-131"></span><span id="getFigure"><span class="annot"><span class="annottext">getFigure :: forall a b. Figure a b -&gt; [([a], [Attribute])]
</span><a href="Algeometry.SVG.html#getFigure"><span class="hs-identifier hs-var hs-var">getFigure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span id="local-6989586621679260313"><span class="annot"><span class="annottext">([([a], [Attribute])], b)
</span><a href="#local-6989586621679260313"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([([a], [Attribute])], b)
</span><a href="#local-6989586621679260313"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | Returns value, stored in Figure type.</span><span>
</span><span id="line-134"></span><span id="local-6989586621679260803"><span id="local-6989586621679260804"><span class="annot"><a href="Algeometry.SVG.html#getResult"><span class="hs-identifier hs-type">getResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260804"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260803"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260803"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-135"></span><span id="getResult"><span class="annot"><span class="annottext">getResult :: forall a b. Figure a b -&gt; b
</span><a href="Algeometry.SVG.html#getResult"><span class="hs-identifier hs-var hs-var">getResult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span id="local-6989586621679260312"><span class="annot"><span class="annottext">([([a], [Attribute])], b)
</span><a href="#local-6989586621679260312"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([([a], [Attribute])], b)
</span><a href="#local-6989586621679260312"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | Applies transformation to objects, stored in Figure type.</span><span>
</span><span id="line-138"></span><span id="local-6989586621679260796"><span id="local-6989586621679260797"><span id="local-6989586621679260798"><span class="annot"><a href="Algeometry.SVG.html#mapFig"><span class="hs-identifier hs-type">mapFig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679260798"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260797"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260798"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260796"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260797"><span class="hs-identifier hs-type">a2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260796"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-139"></span><span id="mapFig"><span class="annot"><span class="annottext">mapFig :: forall a1 a2 b. (a1 -&gt; a2) -&gt; Figure a1 b -&gt; Figure a2 b
</span><a href="Algeometry.SVG.html#mapFig"><span class="hs-identifier hs-var hs-var">mapFig</span></a></span></span><span> </span><span id="local-6989586621679260311"><span class="annot"><span class="annottext">a1 -&gt; a2
</span><a href="#local-6989586621679260311"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679260310"><span class="annot"><span class="annottext">[([a1], [Attribute])]
</span><a href="#local-6989586621679260310"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260309"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679260309"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679260308"><span class="annot"><span class="annottext">[a1]
</span><a href="#local-6989586621679260308"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260307"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260307"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; a2
</span><a href="#local-6989586621679260311"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a1]
</span><a href="#local-6989586621679260308"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260307"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([a1], [Attribute])]
</span><a href="#local-6989586621679260310"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679260309"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Adds multivector as graphic object to Figure.</span><span>
</span><span id="line-142"></span><span id="local-6989586621679260790"><span class="annot"><a href="Algeometry.SVG.html#put"><span class="hs-identifier hs-type">put</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679260790"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260790"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260790"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-143"></span><span id="put"><span class="annot"><span class="annottext">put :: forall a. a -&gt; Figure a a
</span><a href="Algeometry.SVG.html#put"><span class="hs-identifier hs-var hs-var">put</span></a></span></span><span> </span><span id="local-6989586621679260306"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260306"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260306"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260306"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | Adds multivectors as graphic object to Figure.</span><span>
</span><span id="line-146"></span><span id="local-6989586621679260788"><span class="annot"><a href="Algeometry.SVG.html#puts"><span class="hs-identifier hs-type">puts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260788"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260788"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260788"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-147"></span><span id="puts"><span class="annot"><span class="annottext">puts :: forall a. [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#puts"><span class="hs-identifier hs-var hs-var">puts</span></a></span></span><span> </span><span id="local-6989586621679260304"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260304"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. ([([a], [Attribute])], b) -&gt; Figure a b
</span><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-var">Figure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260304"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260304"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-type">@</span></a></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Adds multivector as graphic object with given attributes.</span><span>
</span><span id="line-151"></span><span id="local-6989586621679260786"><span class="annot"><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-type">(@)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679260786"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260786"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260786"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-152"></span><span id="local-6989586621679260302"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260302"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="%40"><span class="annot"><span class="annottext">@ :: forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var hs-var">@</span></a></span></span><span> </span><span id="local-6989586621679260301"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260301"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Figure a a
</span><a href="Algeometry.SVG.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260302"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260301"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#%3C%40"><span class="hs-operator hs-type">&lt;@</span></a></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Appends attributes to attributed object.</span><span>
</span><span id="line-156"></span><span id="local-6989586621679260299"><span id="local-6989586621679260300"><span class="annot"><a href="Algeometry.SVG.html#%3C%40"><span class="hs-operator hs-type">(&lt;@)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260299"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260299"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-157"></span><span id="%3C%40"><span class="annot"><span class="annottext">&lt;@ :: forall a b. Figure a b -&gt; [Attribute] -&gt; Figure a b
</span><a href="Algeometry.SVG.html#%3C%40"><span class="hs-operator hs-var hs-var">(&lt;@)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-identifier hs-var">with</span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">------------------------------</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- geometric objects</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | Returns multivector, which represents the origin.</span><span>
</span><span id="line-163"></span><span id="local-6989586621679260782"><span class="annot"><a href="Algeometry.SVG.html#origin"><span class="hs-identifier hs-type">origin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260782"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260782"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-164"></span><span id="origin"><span class="annot"><span class="annottext">origin :: forall a. GeomAlgebra a =&gt; a
</span><a href="Algeometry.SVG.html#origin"><span class="hs-identifier hs-var hs-var">origin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Returns a label with given value.</span><span>
</span><span id="line-167"></span><span id="local-6989586621679260779"><span id="local-6989586621679260780"><span class="annot"><a href="Algeometry.SVG.html#display"><span class="hs-identifier hs-type">display</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679260780"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260779"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260780"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260779"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260779"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-168"></span><span id="display"><span class="annot"><span class="annottext">display :: forall s a. (Show s, GeomAlgebra a) =&gt; [Double] -&gt; s -&gt; Figure a a
</span><a href="Algeometry.SVG.html#display"><span class="hs-identifier hs-var hs-var">display</span></a></span></span><span> </span><span id="local-6989586621679260291"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260291"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679260290"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679260290"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; String -&gt; Figure a a
</span><a href="Algeometry.SVG.html#label"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260291"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679260290"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | Returns a label at given position.</span><span>
</span><span id="line-171"></span><span id="local-6989586621679260776"><span class="annot"><a href="Algeometry.SVG.html#label"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260776"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260776"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-172"></span><span id="label"><span class="annot"><span class="annottext">label :: forall a. GeomAlgebra a =&gt; [Double] -&gt; String -&gt; Figure a a
</span><a href="Algeometry.SVG.html#label"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679260285"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260285"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679260284"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679260284"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260285"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">id_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679260284"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;label&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Returns multivector, which represents a normalized line.</span><span>
</span><span id="line-175"></span><span id="local-6989586621679260771"><span class="annot"><a href="Algeometry.SVG.html#nline"><span class="hs-identifier hs-type">nline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260771"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-176"></span><span id="nline"><span class="annot"><span class="annottext">nline :: forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#nline"><span class="hs-identifier hs-var hs-var">nline</span></a></span></span><span> </span><span id="local-6989586621679260277"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260277"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260276"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260276"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260277"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260276"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Returns multivector, which represents a line.</span><span>
</span><span id="line-179"></span><span id="local-6989586621679260274"><span class="annot"><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-type">line</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260274"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260274"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-180"></span><span id="line"><span class="annot"><span class="annottext">line :: forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span id="local-6989586621679260269"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260269"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260268"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260268"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260269"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#%2228"><span class="hs-operator hs-var">&#8744;</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260268"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | Returns multivector, which represents a vector (line passing through the origin).</span><span>
</span><span id="line-183"></span><span id="local-6989586621679260266"><span class="annot"><a href="Algeometry.SVG.html#vect"><span class="hs-identifier hs-type">vect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260266"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-184"></span><span id="vect"><span class="annot"><span class="annottext">vect :: forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.SVG.html#vect"><span class="hs-identifier hs-var hs-var">vect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | Returns multivector, which represents a normalized vector (line passing through the origin).</span><span>
</span><span id="line-187"></span><span id="local-6989586621679260263"><span class="annot"><a href="Algeometry.SVG.html#nvect"><span class="hs-identifier hs-type">nvect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260263"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260263"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-188"></span><span id="nvect"><span class="annot"><span class="annottext">nvect :: forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.SVG.html#nvect"><span class="hs-identifier hs-var hs-var">nvect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#nline"><span class="hs-identifier hs-var">nline</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | Returns a graphic object, which represents a polygon.</span><span>
</span><span id="line-191"></span><span id="local-6989586621679260765"><span class="annot"><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260765"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260765"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260765"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260765"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-192"></span><span id="polygon"><span class="annot"><span class="annottext">polygon :: forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-var hs-var">polygon</span></a></span></span><span> </span><span id="local-6989586621679260255"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260255"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Figure a [a]
</span><a href="#local-6989586621679260254"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;polygon&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679260254"><span class="annot"><span class="annottext">res :: Figure a [a]
</span><a href="#local-6989586621679260254"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260255"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>      </span><span id="local-6989586621679260250"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260250"><span class="hs-identifier hs-var">h</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isPoint"><span class="hs-identifier hs-var">isPoint</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260250"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#puts"><span class="hs-identifier hs-var">puts</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260255"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-196"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isLine"><span class="hs-identifier hs-var">isLine</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260250"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679260246"><span class="annot"><span class="annottext">pts' :: [a]
</span><a href="#local-6989586621679260246"><span class="hs-identifier hs-var hs-var">pts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">forall mv. CliffAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#outer"><span class="hs-identifier hs-var">outer</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260255"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260255"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260250"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260255"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#puts"><span class="hs-identifier hs-var">puts</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260246"><span class="hs-identifier hs-var">pts'</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#puts"><span class="hs-identifier hs-var">puts</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260255"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Returns a graphic object, which represents a polyline.</span><span>
</span><span id="line-202"></span><span id="local-6989586621679260242"><span class="annot"><a href="Algeometry.SVG.html#polyline"><span class="hs-identifier hs-type">polyline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-203"></span><span id="polyline"><span class="annot"><span class="annottext">polyline :: forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polyline"><span class="hs-identifier hs-var hs-var">polyline</span></a></span></span><span> </span><span id="local-6989586621679260237"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260237"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-var">polygon</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679260237"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;polyline&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | Returns a graphic object, which represents a regular polygon.</span><span>
</span><span id="line-206"></span><span id="local-6989586621679260753"><span class="annot"><a href="Algeometry.SVG.html#regularPoly"><span class="hs-identifier hs-type">regularPoly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-207"></span><span id="regularPoly"><span class="annot"><span class="annottext">regularPoly :: forall a. GeomAlgebra a =&gt; Double -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#regularPoly"><span class="hs-identifier hs-var hs-var">regularPoly</span></a></span></span><span> </span><span id="local-6989586621679260214"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260214"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-var">polygon</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260210"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260210"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679260210"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260210"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260214"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260214"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260214"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Returns a graphic object, which represents a segment? given by two points.</span><span>
</span><span id="line-211"></span><span id="local-6989586621679260748"><span class="annot"><a href="Algeometry.SVG.html#segment"><span class="hs-identifier hs-type">segment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260748"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260748"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260748"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260748"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260748"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-212"></span><span id="segment"><span class="annot"><span class="annottext">segment :: forall a. GeomAlgebra a =&gt; a -&gt; a -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#segment"><span class="hs-identifier hs-var hs-var">segment</span></a></span></span><span> </span><span id="local-6989586621679260205"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260205"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679260204"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260204"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polyline"><span class="hs-identifier hs-var">polyline</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260205"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260204"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Returns a graphic object, which represents a segment given by coordinates.</span><span>
</span><span id="line-215"></span><span id="local-6989586621679260746"><span class="annot"><a href="Algeometry.SVG.html#segm"><span class="hs-identifier hs-type">segm</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260746"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260746"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260746"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-218"></span><span id="segm"><span class="annot"><span class="annottext">segm :: forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#segm"><span class="hs-identifier hs-var hs-var">segm</span></a></span></span><span> </span><span id="local-6989586621679260199"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260199"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260198"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260198"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; a -&gt; a -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#segment"><span class="hs-identifier hs-var">segment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260199"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260198"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | Returns multivector, which represents a plane passing through three points.</span><span>
</span><span id="line-221"></span><span id="local-6989586621679260744"><span class="annot"><a href="Algeometry.SVG.html#plane"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260744"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260744"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-223"></span><span id="plane"><span class="annot"><span class="annottext">plane :: forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#plane"><span class="hs-identifier hs-var hs-var">plane</span></a></span></span><span> </span><span id="local-6989586621679260191"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260191"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260190"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260190"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679260189"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260189"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260191"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260190"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260189"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- | Returns graphic object, which represents a plane passing through a point and a line.</span><span>
</span><span id="line-226"></span><span id="local-6989586621679260742"><span class="annot"><a href="Algeometry.SVG.html#plane2"><span class="hs-identifier hs-type">plane2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260742"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260742"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260742"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260742"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260742"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-227"></span><span id="plane2"><span class="annot"><span class="annottext">plane2 :: forall a. GeomAlgebra a =&gt; a -&gt; a -&gt; XY -&gt; Figure a a
</span><a href="Algeometry.SVG.html#plane2"><span class="hs-identifier hs-var hs-var">plane2</span></a></span></span><span> </span><span id="local-6989586621679260171"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260171"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679260170"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260170"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260169"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260169"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260168"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260168"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-var">polygon</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260166"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260168"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260170"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260169"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260171"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-229"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260166"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260168"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260170"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260169"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260171"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span>
</span><span id="line-230"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260166"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260168"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260170"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260169"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260165"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-231"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260166"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260168"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Double -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#shiftAlong%27"><span class="hs-identifier hs-var">shiftAlong'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260170"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260169"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260165"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260171"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#%2228"><span class="hs-operator hs-var">&#8744;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260170"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679260165"><span class="annot"><span class="annottext">p' :: a
</span><a href="#local-6989586621679260165"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260171"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#-%3E%7C"><span class="hs-operator hs-var">-&gt;|</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260170"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621679260166"><span class="annot"><span class="annottext">l' :: a
</span><a href="#local-6989586621679260166"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260171"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260165"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Returns graphic object, which represents a plane passing through a point, orthogonal to a line.</span><span>
</span><span id="line-238"></span><span id="local-6989586621679260161"><span class="annot"><a href="Algeometry.SVG.html#orthoPlane"><span class="hs-identifier hs-type">orthoPlane</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260161"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260161"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260161"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260161"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260161"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-242"></span><span id="orthoPlane"><span class="annot"><span class="annottext">orthoPlane :: forall a. GeomAlgebra a =&gt; a -&gt; a -&gt; XY -&gt; Figure a a
</span><a href="Algeometry.SVG.html#orthoPlane"><span class="hs-identifier hs-var hs-var">orthoPlane</span></a></span></span><span> </span><span id="local-6989586621679260157"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260157"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679260156"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260156"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; a -&gt; a -&gt; XY -&gt; Figure a a
</span><a href="Algeometry.SVG.html#plane2"><span class="hs-identifier hs-var">plane2</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260157"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260155"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679260153"><span class="annot"><span class="annottext">p' :: a
</span><a href="#local-6989586621679260153"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260157"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#-%3E%7C"><span class="hs-operator hs-var">-&gt;|</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260156"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621679260155"><span class="annot"><span class="annottext">l :: a
</span><a href="#local-6989586621679260155"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260153"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. CliffAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#inner"><span class="hs-operator hs-var">`inner`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260157"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260156"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | Returns graphic object, which represents a plane passing through three points.</span><span>
</span><span id="line-248"></span><span id="local-6989586621679260738"><span class="annot"><a href="Algeometry.SVG.html#plane3"><span class="hs-identifier hs-type">plane3</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260738"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260738"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260738"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260738"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260738"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260738"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-252"></span><span id="plane3"><span class="annot"><span class="annottext">plane3 :: forall a. GeomAlgebra a =&gt; a -&gt; a -&gt; a -&gt; XY -&gt; Figure a a
</span><a href="Algeometry.SVG.html#plane3"><span class="hs-identifier hs-var hs-var">plane3</span></a></span></span><span> </span><span id="local-6989586621679260146"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260146"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679260145"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260145"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679260144"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260144"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; a -&gt; a -&gt; XY -&gt; Figure a a
</span><a href="Algeometry.SVG.html#plane2"><span class="hs-identifier hs-var">plane2</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260146"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260145"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679260144"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- rplane</span><span>
</span><span id="line-255"></span><span class="hs-comment">--   :: (Fractional a, GeomAlgebra a)</span><span>
</span><span id="line-256"></span><span class="hs-comment">--   =&gt; a -&gt; Double -&gt; String -&gt; String</span><span>
</span><span id="line-257"></span><span class="hs-comment">--   -&gt; Figure a a</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- rplane p r col lab = do</span><span>
</span><span id="line-259"></span><span class="hs-comment">--   polygon pts attr'</span><span>
</span><span id="line-260"></span><span class="hs-comment">--   sequence [ segment p0 pt attr' | pt &lt;- pts ]</span><span>
</span><span id="line-261"></span><span class="hs-comment">--   if not (null lab)</span><span>
</span><span id="line-262"></span><span class="hs-comment">--     then p2 @ [stroke_width_ &quot;0&quot;, fill_ &quot;none&quot;, id_ (pack lab)]</span><span>
</span><span id="line-263"></span><span class="hs-comment">--     else return p</span><span>
</span><span id="line-264"></span><span class="hs-comment">--   return p</span><span>
</span><span id="line-265"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-266"></span><span class="hs-comment">--     p0 = point [] -&gt;| p</span><span>
</span><span id="line-267"></span><span class="hs-comment">--     p1 = point [log 2, sqrt 2, sin 2] -&gt;| p</span><span>
</span><span id="line-268"></span><span class="hs-comment">--     p2 = shiftAlong' (p0 `join` p1) r p0</span><span>
</span><span id="line-269"></span><span class="hs-comment">--     n = point [] |- p</span><span>
</span><span id="line-270"></span><span class="hs-comment">--     pts = [ rotateAt n a p2 | a &lt;- [0,pi/20..2*pi] ]</span><span>
</span><span id="line-271"></span><span class="hs-comment">--     attr' = [fill_ (pack col), stroke_ (pack col), opacity_ &quot;0.25&quot;]</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Adds 2D axes to a Figure</span><span>
</span><span id="line-274"></span><span class="annot"><a href="Algeometry.SVG.html#axis"><span class="hs-identifier hs-type">axis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span>
</span><span id="line-275"></span><span id="axis"><span class="annot"><span class="annottext">axis :: Figure PGA2 PGA2
</span><a href="Algeometry.SVG.html#axis"><span class="hs-identifier hs-var hs-var">axis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;0.25&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;0.25&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | Adds 2D unit grid to a Figure</span><span>
</span><span id="line-280"></span><span class="annot"><a href="Algeometry.SVG.html#grid"><span class="hs-identifier hs-type">grid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span id="grid"><span class="annot"><span class="annottext">grid :: Figure PGA2 ()
</span><a href="Algeometry.SVG.html#grid"><span class="hs-identifier hs-var hs-var">grid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260142"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260142"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">forall {b}. GeomAlgebra b =&gt; Double -&gt; Figure b b
</span><a href="#local-6989586621679260140"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">19</span></span><span class="hs-special">]</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679260140"><span class="annot"><span class="annottext">mk :: Double -&gt; Figure b b
</span><a href="#local-6989586621679260140"><span class="hs-identifier hs-var hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679260127"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260142"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260142"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260142"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [Double] -&gt; [Double] -&gt; a
</span><a href="Algeometry.SVG.html#line"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260127"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Attribute] -&gt; Figure a a
</span><a href="Algeometry.SVG.html#%40"><span class="hs-operator hs-var">@</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260142"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621679260142"><span class="annot"><span class="annottext">attr :: [Attribute]
</span><a href="#local-6989586621679260142"><span class="hs-identifier hs-var hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;lightgray&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;0.2&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Adds 2D background rectangle to a Figure</span><span>
</span><span id="line-294"></span><span id="local-6989586621679260731"><span class="annot"><a href="Algeometry.SVG.html#background"><span class="hs-identifier hs-type">background</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.GeometricAlgebra.html#GeomAlgebra"><span class="hs-identifier hs-type">GeomAlgebra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260731"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260731"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679260731"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-295"></span><span id="background"><span class="annot"><span class="annottext">background :: forall a. GeomAlgebra a =&gt; String -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#background"><span class="hs-identifier hs-var hs-var">background</span></a></span></span><span> </span><span id="local-6989586621679260119"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679260119"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GeomAlgebra a =&gt; [a] -&gt; Figure a [a]
</span><a href="Algeometry.SVG.html#polygon"><span class="hs-identifier hs-var">polygon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;bg&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679260119"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-296"></span><span>    </span><span>
</span><span id="line-297"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | Returns a figure as a list of primitives.</span><span>
</span><span id="line-299"></span><span id="local-6989586621679260729"><span class="annot"><a href="Algeometry.SVG.html#figure"><span class="hs-identifier hs-type">figure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260729"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-type">Fig</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-300"></span><span id="figure"><span class="annot"><span class="annottext">figure :: forall b. Figure PGA2 b -&gt; [Fig]
</span><a href="Algeometry.SVG.html#figure"><span class="hs-identifier hs-var hs-var">figure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">([PGA2], [Attribute]) -&gt; [Fig]
</span><a href="#local-6989586621679260114"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. Figure a b -&gt; [([a], [Attribute])]
</span><a href="Algeometry.SVG.html#getFigure"><span class="hs-identifier hs-var">getFigure</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679260114"><span class="annot"><span class="annottext">draw :: ([PGA2], [Attribute]) -&gt; [Fig]
</span><a href="#local-6989586621679260114"><span class="hs-identifier hs-var hs-var">draw</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260098"><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679260098"><span class="hs-identifier hs-var">mvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679260097"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260097"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679260098"><span class="hs-identifier hs-var">mvs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679260096"><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679260096"><span class="hs-identifier hs-var">mv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isPoint"><span class="hs-identifier hs-var">isPoint</span></a></span><span> </span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679260096"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Attribute] -&gt; XY -&gt; Fig
</span><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260097"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {mv}. GeomAlgebra mv =&gt; mv -&gt; XY
</span><a href="#local-6989586621679260095"><span class="hs-identifier hs-var">xy</span></a></span><span> </span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679260096"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isLine"><span class="hs-identifier hs-var">isLine</span></a></span><span> </span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679260096"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {mv}. GeomAlgebra mv =&gt; mv -&gt; XY
</span><a href="#local-6989586621679260095"><span class="hs-identifier hs-var">xy</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PGA2 -&gt; [PGA2]
</span><a href="Algeometry.SVG.html#clip"><span class="hs-identifier hs-var">clip</span></a></span><span> </span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679260096"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-305"></span><span>               </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>               </span><span class="hs-special">[</span><span id="local-6989586621679260094"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260094"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Attribute] -&gt; XY -&gt; Fig
</span><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260097"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260094"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>               </span><span id="local-6989586621679260093"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260093"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679260092"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260092"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[XY]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Attribute] -&gt; XY -&gt; XY -&gt; Fig
</span><a href="Algeometry.SVG.html#Line"><span class="hs-identifier hs-var">Line</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260097"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260093"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260092"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-308"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">[PGA2]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isPoint"><span class="hs-identifier hs-var">isPoint</span></a></span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679260098"><span class="hs-identifier hs-var">mvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Attribute] -&gt; [XY] -&gt; Fig
</span><a href="Algeometry.SVG.html#Polygon"><span class="hs-identifier hs-var">Polygon</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260097"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {mv}. GeomAlgebra mv =&gt; mv -&gt; XY
</span><a href="#local-6989586621679260095"><span class="hs-identifier hs-var">xy</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679260098"><span class="hs-identifier hs-var">mvs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[PGA2]
</span><a href="#local-6989586621679260098"><span class="hs-identifier hs-var">mvs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679260090"><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679260090"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([PGA2], [Attribute]) -&gt; [Fig]
</span><a href="#local-6989586621679260114"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">PGA2
</span><a href="#local-6989586621679260090"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260097"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>      </span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679260095"><span class="annot"><span class="annottext">xy :: mv -&gt; XY
</span><a href="#local-6989586621679260095"><span class="hs-identifier hs-var hs-var">xy</span></a></span></span><span> </span><span id="local-6989586621679260084"><span class="annot"><span class="annottext">mv
</span><a href="#local-6989586621679260084"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; [Double]
</span><a href="Algeometry.GeometricAlgebra.html#coord"><span class="hs-identifier hs-var">coord</span></a></span><span> </span><span class="annot"><span class="annottext">mv
</span><a href="#local-6989586621679260084"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679260082"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260082"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260082"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>      </span><span id="local-6989586621679260081"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260081"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679260080"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260080"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260081"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260080"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | Projects 3D points to a 2D plane, using given viewpoint.</span><span>
</span><span id="line-318"></span><span id="local-6989586621679260717"><span class="annot"><a href="Algeometry.SVG.html#viewPoint"><span class="hs-identifier hs-type">viewPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA3"><span class="hs-identifier hs-type">PGA3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260717"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260717"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-319"></span><span id="viewPoint"><span class="annot"><span class="annottext">viewPoint :: forall b. [Double] -&gt; Figure PGA3 b -&gt; Figure PGA2 b
</span><a href="Algeometry.SVG.html#viewPoint"><span class="hs-identifier hs-var hs-var">viewPoint</span></a></span></span><span> </span><span id="local-6989586621679260078"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260078"><span class="hs-identifier hs-var">vp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a1 a2 b. (a1 -&gt; a2) -&gt; Figure a1 b -&gt; Figure a2 b
</span><a href="Algeometry.SVG.html#mapFig"><span class="hs-identifier hs-var">mapFig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">coerce :: forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-type">coerce</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PGA3 -&gt; PGA3
</span><a href="#local-6989586621679260077"><span class="hs-identifier hs-var">project</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679260072"><span class="annot"><span class="annottext">p0 :: PGA3
</span><a href="#local-6989586621679260072"><span class="hs-identifier hs-var hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall mv. CliffAlgebra mv =&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#dual"><span class="hs-identifier hs-var">dual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260078"><span class="hs-identifier hs-var">vp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621679260077"><span class="annot"><span class="annottext">project :: PGA3 -&gt; PGA3
</span><a href="#local-6989586621679260077"><span class="hs-identifier hs-var hs-var">project</span></a></span></span><span> </span><span id="local-6989586621679260052"><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260052"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isPoint"><span class="hs-identifier hs-var">isPoint</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260052"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260052"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260078"><span class="hs-identifier hs-var">vp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#meet"><span class="hs-operator hs-var">`meet`</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260072"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260072"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; Bool
</span><a href="Algeometry.GeometricAlgebra.html#isLine"><span class="hs-identifier hs-var">isLine</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260052"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260052"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260078"><span class="hs-identifier hs-var">vp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#meet"><span class="hs-operator hs-var">`meet`</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260072"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260072"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-325"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260052"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#join"><span class="hs-operator hs-var">`join`</span></a></span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; [Double] -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#point"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679260078"><span class="hs-identifier hs-var">vp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall mv. GeomAlgebra mv =&gt; mv -&gt; mv -&gt; mv
</span><a href="Algeometry.GeometricAlgebra.html#meet"><span class="hs-operator hs-var">`meet`</span></a></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260072"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">PGA3
</span><a href="#local-6989586621679260072"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span id="rescaleTo"><span class="annot"><span class="annottext">rescaleTo :: XY -&gt; Fig -&gt; Fig
</span><a href="Algeometry.SVG.html#rescaleTo"><span class="hs-identifier hs-var hs-var">rescaleTo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260048"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260048"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679260047"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260047"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679260046"><span class="annot"><span class="annottext">Fig
</span><a href="#local-6989586621679260046"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Fig
</span><a href="#local-6989586621679260046"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679260045"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260045"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679260044"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260044"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; XY -&gt; Fig
</span><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260045"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XY -&gt; XY
</span><a href="#local-6989586621679260043"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260044"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span id="local-6989586621679260042"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260042"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679260041"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260041"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679260040"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260040"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; XY -&gt; XY -&gt; Fig
</span><a href="Algeometry.SVG.html#Line"><span class="hs-identifier hs-var">Line</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260042"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XY -&gt; XY
</span><a href="#local-6989586621679260043"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260041"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XY -&gt; XY
</span><a href="#local-6989586621679260043"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679260040"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span id="local-6989586621679260039"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260039"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679260038"><span class="annot"><span class="annottext">[XY]
</span><a href="#local-6989586621679260038"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [XY] -&gt; Fig
</span><a href="Algeometry.SVG.html#Polygon"><span class="hs-identifier hs-var">Polygon</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679260039"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XY -&gt; XY
</span><a href="#local-6989586621679260043"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[XY]
</span><a href="#local-6989586621679260038"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621679260043"><span class="annot"><span class="annottext">sc :: XY -&gt; XY
</span><a href="#local-6989586621679260043"><span class="hs-identifier hs-var hs-var">sc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679260021"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260021"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679260020"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260020"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260048"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260021"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260048"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260047"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260020"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679260047"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span id="local-6989586621679260714"><span class="annot"><a href="Algeometry.SVG.html#renderFig"><span class="hs-identifier hs-type">renderFig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679260714"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-type">Fig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HtmlT</span></span><span> </span><span class="annot"><a href="#local-6989586621679260714"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-337"></span><span id="renderFig"><span class="annot"><span class="annottext">renderFig :: forall (m :: * -&gt; *). Monad m =&gt; Fig -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#renderFig"><span class="hs-identifier hs-var hs-var">renderFig</span></a></span></span><span> </span><span id="local-6989586621679259944"><span class="annot"><span class="annottext">Fig
</span><a href="#local-6989586621679259944"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Fig
</span><a href="#local-6989586621679259944"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679259943"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259943"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259942"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259942"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259941"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259941"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Text]
</span><a href="#local-6989586621679259940"><span class="hs-identifier hs-var">getClass</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259943"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;label&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-341"></span><span>      </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">circle_</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">cx_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259942"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">cy_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259941"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">r_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;2.25&quot;</span></span><span>
</span><span id="line-345"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;black&quot;</span></span><span>
</span><span id="line-346"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;white&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259943"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Text]
</span><a href="#local-6989586621679259935"><span class="hs-identifier hs-var">getId</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259943"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679259934"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679259934"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ToHtml a, Monad m) =&gt;
a -&gt; XY -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#mkLabel"><span class="hs-identifier hs-var">mkLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679259934"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259942"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259941"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>      </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-350"></span><span>      </span><span>
</span><span id="line-351"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span id="local-6989586621679259932"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259932"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679259931"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679259931"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679259930"><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679259930"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Text]
</span><a href="#local-6989586621679259940"><span class="hs-identifier hs-var">getClass</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259932"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;label&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-354"></span><span>      </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-355"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">polyline_</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">points_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. (Show a, Show a) =&gt; (a, a) -&gt; String
</span><a href="#local-6989586621679259927"><span class="hs-identifier hs-var">toStr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679259931"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679259930"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259932"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Text]
</span><a href="#local-6989586621679259935"><span class="hs-identifier hs-var">getId</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259932"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679259926"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259925"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259925"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259924"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259924"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679259931"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-359"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259923"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259923"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259922"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259922"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XY
</span><a href="#local-6989586621679259930"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-360"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679259913"><span class="annot"><span class="annottext">n :: Double
</span><a href="#local-6989586621679259913"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259925"><span class="hs-identifier hs-var">x1</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259923"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259924"><span class="hs-identifier hs-var">y1</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259922"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>        </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ToHtml a, Monad m) =&gt;
a -&gt; XY -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#mkLabel"><span class="hs-identifier hs-var">mkLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679259926"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259923"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259913"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259925"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259923"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259922"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">20</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259913"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259924"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259922"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>      </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-363"></span><span> </span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><a href="Algeometry.SVG.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span id="local-6989586621679259910"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259910"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679259909"><span class="annot"><span class="annottext">[XY]
</span><a href="#local-6989586621679259909"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; [Text]
</span><a href="#local-6989586621679259940"><span class="hs-identifier hs-var">getClass</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259910"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;polygon&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-367"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">polygon_</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">points_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. (Show a, Show a) =&gt; (a, a) -&gt; String
</span><a href="#local-6989586621679259927"><span class="hs-identifier hs-var">toStr</span></a></span><span> </span><span class="annot"><span class="annottext">[XY]
</span><a href="#local-6989586621679259909"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259910"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;polyline&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">polyline_</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">points_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. (Show a, Show a) =&gt; (a, a) -&gt; String
</span><a href="#local-6989586621679259927"><span class="hs-identifier hs-var">toStr</span></a></span><span> </span><span class="annot"><span class="annottext">[XY]
</span><a href="#local-6989586621679259909"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259910"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;bg&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-371"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">rect_</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;100%&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">height_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;100%&quot;</span></span><span>
</span><span id="line-372"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;none&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_opacity_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;1&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-operator hs-var">`with`</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679259910"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-373"></span><span>      </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>    </span><span id="local-6989586621679259927"><span class="annot"><span class="annottext">toStr :: (a, a) -&gt; String
</span><a href="#local-6989586621679259927"><span class="hs-identifier hs-var hs-var">toStr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259891"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679259891"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679259890"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679259890"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679259891"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679259890"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-377"></span><span>    </span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621679259935"><span class="annot"><span class="annottext">getId :: [Attribute] -&gt; [Text]
</span><a href="#local-6989586621679259935"><span class="hs-identifier hs-var hs-var">getId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-379"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;id&quot;</span></span><span> </span><span id="local-6989586621679259887"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679259887"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679259887"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-380"></span><span>      </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621679259940"><span class="annot"><span class="annottext">getClass :: [Attribute] -&gt; [Text]
</span><a href="#local-6989586621679259940"><span class="hs-identifier hs-var hs-var">getClass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-383"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;class&quot;</span></span><span> </span><span id="local-6989586621679259884"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679259884"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679259884"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span id="local-6989586621679260704"><span id="local-6989586621679260705"><span class="annot"><a href="Algeometry.SVG.html#mkLabel"><span class="hs-identifier hs-type">mkLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToHtml</span></span><span> </span><span class="annot"><a href="#local-6989586621679260705"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679260704"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679260705"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#XY"><span class="hs-identifier hs-type">XY</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HtmlT</span></span><span> </span><span class="annot"><a href="#local-6989586621679260704"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-387"></span><span id="mkLabel"><span class="annot"><span class="annottext">mkLabel :: forall a (m :: * -&gt; *).
(ToHtml a, Monad m) =&gt;
a -&gt; XY -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#mkLabel"><span class="hs-identifier hs-var hs-var">mkLabel</span></a></span></span><span> </span><span id="local-6989586621679259853"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679259853"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259852"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259852"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259851"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259851"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span>  </span><span class="annot"><span class="annottext">forall arg result. Term arg result =&gt; arg -&gt; result
</span><span class="hs-identifier hs-var">text_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">x_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. RealFloat a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259852"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">y_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. RealFloat a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259851"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;white&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;white&quot;</span></span><span>
</span><span id="line-391"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;5&quot;</span></span><span>
</span><span id="line-392"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall arg result. Term arg result =&gt; arg -&gt; result
</span><span class="hs-identifier hs-var">filter_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;url(#blur1)&quot;</span></span><span>
</span><span id="line-393"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">text_anchor_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;middle&quot;</span></span><span>
</span><span id="line-394"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">opacity_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ToHtml a, Monad m) =&gt; a -&gt; HtmlT m ()
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679259853"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><span class="annottext">forall arg result. Term arg result =&gt; arg -&gt; result
</span><span class="hs-identifier hs-var">text_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">x_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. RealFloat a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259852"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">y_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. RealFloat a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259851"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;none&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;black&quot;</span></span><span>
</span><span id="line-398"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">text_anchor_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;middle&quot;</span></span><span>
</span><span id="line-399"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">opacity_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ToHtml a, Monad m) =&gt; a -&gt; HtmlT m ()
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679259853"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Returns raw SVG for a figure.</span><span>
</span><span id="line-402"></span><span id="local-6989586621679260688"><span class="annot"><a href="Algeometry.SVG.html#svg"><span class="hs-identifier hs-type">svg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679260688"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-type">Fig</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HtmlT</span></span><span> </span><span class="annot"><a href="#local-6989586621679260688"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-403"></span><span id="svg"><span class="annot"><span class="annottext">svg :: forall (m :: * -&gt; *). Monad m =&gt; [Fig] -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#svg"><span class="hs-identifier hs-var hs-var">svg</span></a></span></span><span> </span><span id="local-6989586621679259824"><span class="annot"><span class="annottext">[Fig]
</span><a href="#local-6989586621679259824"><span class="hs-identifier hs-var">fig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-404"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; SvgT m ()
</span><span class="hs-identifier hs-var">doctype_</span></span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><span class="annottext">forall a. With a =&gt; a -&gt; [Attribute] -&gt; a
</span><span class="hs-identifier hs-var">with</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s t. Term [Attribute] (s -&gt; t) =&gt; s -&gt; t
</span><span class="hs-identifier hs-var">svg11_</span></span><span> </span><span class="annot"><span class="annottext">HtmlT m ()
</span><a href="#local-6989586621679259821"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;400&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">height_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;400&quot;</span></span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;black&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;none&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_opacity_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;0.75&quot;</span></span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">font_size_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;14&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">font_style_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;italic&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">font_family_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;sans-serif&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>    </span><span id="local-6989586621679259821"><span class="annot"><span class="annottext">content :: HtmlT m ()
</span><a href="#local-6989586621679259821"><span class="hs-identifier hs-var hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>      </span><span class="annot"><span class="annottext">forall arg result. Term arg result =&gt; arg -&gt; result
</span><span class="hs-identifier hs-var">filter_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">id_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;blur1&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">feGaussianBlur_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stdDeviation_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;0.5&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-412"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [Attribute] -&gt; SvgT m ()
</span><span class="hs-identifier hs-var">rect_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">width_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;100%&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">height_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;100%&quot;</span></span><span>
</span><span id="line-413"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;white&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">stroke_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;none&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Attribute
</span><span class="hs-identifier hs-var">fill_opacity_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;1&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-414"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; Fig -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#renderFig"><span class="hs-identifier hs-var">renderFig</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XY -&gt; Fig -&gt; Fig
</span><a href="Algeometry.SVG.html#rescaleTo"><span class="hs-identifier hs-var">rescaleTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">400</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">400</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">[Fig]
</span><a href="#local-6989586621679259824"><span class="hs-identifier hs-var">fig</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | Outputs figure to SVG file.</span><span>
</span><span id="line-417"></span><span id="local-6989586621679260680"><span class="annot"><a href="Algeometry.SVG.html#writeSVG"><span class="hs-identifier hs-type">writeSVG</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260680"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-418"></span><span id="writeSVG"><span class="annot"><span class="annottext">writeSVG :: forall b. String -&gt; Figure PGA2 b -&gt; IO ()
</span><a href="Algeometry.SVG.html#writeSVG"><span class="hs-identifier hs-var hs-var">writeSVG</span></a></span></span><span> </span><span id="local-6989586621679259786"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259786"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span id="local-6989586621679259785"><span class="annot"><span class="annottext">Figure PGA2 b
</span><a href="#local-6989586621679259785"><span class="hs-identifier hs-var">figs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>  </span><span id="local-6989586621679259784"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259784"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><span class="hs-identifier hs-var">openFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259786"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span>
</span><span id="line-420"></span><span>  </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Handle -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">hPrint</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259784"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [Fig] -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#svg"><span class="hs-identifier hs-var">svg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b. Figure PGA2 b -&gt; [Fig]
</span><a href="Algeometry.SVG.html#figure"><span class="hs-identifier hs-var">figure</span></a></span><span> </span><span class="annot"><span class="annottext">Figure PGA2 b
</span><a href="#local-6989586621679259785"><span class="hs-identifier hs-var">figs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259784"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">-- | Outputs figure to PNG file.</span><span>
</span><span id="line-424"></span><span id="local-6989586621679259779"><span class="annot"><a href="Algeometry.SVG.html#writePNG"><span class="hs-identifier hs-type">writePNG</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679259779"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-425"></span><span id="writePNG"><span class="annot"><span class="annottext">writePNG :: forall b. String -&gt; Figure PGA2 b -&gt; IO ()
</span><a href="Algeometry.SVG.html#writePNG"><span class="hs-identifier hs-var hs-var">writePNG</span></a></span></span><span> </span><span id="local-6989586621679259766"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259766"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span id="local-6989586621679259765"><span class="annot"><span class="annottext">Figure PGA2 b
</span><a href="#local-6989586621679259765"><span class="hs-identifier hs-var">figs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679259761"><span class="annot"><span class="annottext">svgFile :: String
</span><a href="#local-6989586621679259761"><span class="hs-identifier hs-var hs-var">svgFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259766"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.svg&quot;</span></span><span>
</span><span id="line-427"></span><span>      </span><span id="local-6989586621679259757"><span class="annot"><span class="annottext">pngFile :: String
</span><a href="#local-6989586621679259757"><span class="hs-identifier hs-var hs-var">pngFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259766"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.png&quot;</span></span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><span class="annottext">forall b. String -&gt; Figure PGA2 b -&gt; IO ()
</span><a href="Algeometry.SVG.html#writeSVG"><span class="hs-identifier hs-var">writeSVG</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259761"><span class="hs-identifier hs-var">svgFile</span></a></span><span> </span><span class="annot"><span class="annottext">Figure PGA2 b
</span><a href="#local-6989586621679259765"><span class="hs-identifier hs-var">figs</span></a></span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679259753"><span class="annot"><span class="annottext">opts :: [String]
</span><a href="#local-6989586621679259753"><span class="hs-identifier hs-var hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-density&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;150&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259761"><span class="hs-identifier hs-var">svgFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259757"><span class="hs-identifier hs-var">pngFile</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679259752"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259752"><span class="hs-identifier hs-var">hout</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CreateProcess
-&gt; IO (Maybe Handle, Maybe Handle, Maybe Handle, ProcessHandle)
</span><span class="hs-identifier hs-var">createProcess</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; CreateProcess
</span><span class="hs-identifier hs-var">proc</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;convert&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679259753"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">std_out :: StdStream
</span><span class="hs-identifier hs-var">std_out</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdStream
</span><span class="hs-identifier hs-var">CreatePipe</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-431"></span><span>  </span><span id="local-6989586621679259747"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259747"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><span class="hs-identifier hs-var">hGetContents</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259752"><span class="hs-identifier hs-var">hout</span></a></span><span>
</span><span id="line-432"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259747"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>  </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259757"><span class="hs-identifier hs-var">pngFile</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="hs-comment">-- | Type representing animationa frames. </span><span>
</span><span id="line-438"></span><span class="hs-keyword">newtype</span><span> </span><span id="Animation"><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-var">Animation</span></a></span></span><span> </span><span id="local-6989586621679260664"><span class="annot"><a href="#local-6989586621679260664"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Animation"><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-var">Animation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.SVG.html#Fig"><span class="hs-identifier hs-type">Fig</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679260664"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259735"><span id="local-6989586621679259737"><span id="local-6989586621679259742"><span class="annot"><span class="annottext">Int -&gt; Animation a -&gt; ShowS
forall a. Show a =&gt; Int -&gt; Animation a -&gt; ShowS
forall a. Show a =&gt; [Animation a] -&gt; ShowS
forall a. Show a =&gt; Animation a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Animation a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Animation a] -&gt; ShowS
show :: Animation a -&gt; String
$cshow :: forall a. Show a =&gt; Animation a -&gt; String
showsPrec :: Int -&gt; Animation a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Animation a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259727"><span id="local-6989586621679259731"><span class="annot"><span class="annottext">forall a b. a -&gt; Animation b -&gt; Animation a
forall a b. (a -&gt; b) -&gt; Animation a -&gt; Animation b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; Animation b -&gt; Animation a
$c&lt;$ :: forall a b. a -&gt; Animation b -&gt; Animation a
fmap :: forall a b. (a -&gt; b) -&gt; Animation a -&gt; Animation b
$cfmap :: forall a b. (a -&gt; b) -&gt; Animation a -&gt; Animation b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259700"><span id="local-6989586621679259705"><span id="local-6989586621679259710"><span id="local-6989586621679259715"><span id="local-6989586621679259720"><span class="annot"><span class="annottext">Functor Animation
forall a. a -&gt; Animation a
forall a b. Animation a -&gt; Animation b -&gt; Animation a
forall a b. Animation a -&gt; Animation b -&gt; Animation b
forall a b. Animation (a -&gt; b) -&gt; Animation a -&gt; Animation b
forall a b c.
(a -&gt; b -&gt; c) -&gt; Animation a -&gt; Animation b -&gt; Animation c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: forall a b. Animation a -&gt; Animation b -&gt; Animation a
$c&lt;* :: forall a b. Animation a -&gt; Animation b -&gt; Animation a
*&gt; :: forall a b. Animation a -&gt; Animation b -&gt; Animation b
$c*&gt; :: forall a b. Animation a -&gt; Animation b -&gt; Animation b
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Animation a -&gt; Animation b -&gt; Animation c
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Animation a -&gt; Animation b -&gt; Animation c
&lt;*&gt; :: forall a b. Animation (a -&gt; b) -&gt; Animation a -&gt; Animation b
$c&lt;*&gt; :: forall a b. Animation (a -&gt; b) -&gt; Animation a -&gt; Animation b
pure :: forall a. a -&gt; Animation a
$cpure :: forall a. a -&gt; Animation a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259682"><span id="local-6989586621679259687"><span id="local-6989586621679259692"><span class="annot"><span class="annottext">Applicative Animation
forall a. a -&gt; Animation a
forall a b. Animation a -&gt; Animation b -&gt; Animation b
forall a b. Animation a -&gt; (a -&gt; Animation b) -&gt; Animation b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: forall a. a -&gt; Animation a
$creturn :: forall a. a -&gt; Animation a
&gt;&gt; :: forall a b. Animation a -&gt; Animation b -&gt; Animation b
$c&gt;&gt; :: forall a b. Animation a -&gt; Animation b -&gt; Animation b
&gt;&gt;= :: forall a b. Animation a -&gt; (a -&gt; Animation b) -&gt; Animation b
$c&gt;&gt;= :: forall a b. Animation a -&gt; (a -&gt; Animation b) -&gt; Animation b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">-- | Outputs single frame of animation, given by a frame number. </span><span>
</span><span id="line-442"></span><span id="writeFrame"><span class="annot"><span class="annottext">writeFrame :: Int -&gt; String -&gt; Animation a -&gt; IO ()
</span><a href="Algeometry.SVG.html#writeFrame"><span class="hs-identifier hs-var hs-var">writeFrame</span></a></span></span><span> </span><span id="local-6989586621679259669"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679259669"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679259668"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259668"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259667"><span class="annot"><span class="annottext">[[Fig]]
</span><a href="#local-6989586621679259667"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679259666"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259666"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><span class="hs-identifier hs-var">openFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259668"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span>
</span><span id="line-444"></span><span>     </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Handle -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">hPrint</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259666"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [Fig] -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#svg"><span class="hs-identifier hs-var">svg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Fig]]
</span><a href="#local-6989586621679259667"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679259669"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>     </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259666"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-446"></span><span>     </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259668"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="hs-comment">-- | Outputs  animation as GIF file, using `convert` utility.</span><span>
</span><span id="line-449"></span><span id="local-6989586621679260642"><span class="annot"><a href="Algeometry.SVG.html#runAnimation"><span class="hs-identifier hs-type">runAnimation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260642"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-450"></span><span id="runAnimation"><span class="annot"><span class="annottext">runAnimation :: forall a. String -&gt; Animation a -&gt; IO ()
</span><a href="Algeometry.SVG.html#runAnimation"><span class="hs-identifier hs-var hs-var">runAnimation</span></a></span></span><span> </span><span id="local-6989586621679259637"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259637"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259636"><span class="annot"><span class="annottext">[[Fig]]
</span><a href="#local-6989586621679259636"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-451"></span><span>  </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;producing SVG..&quot;</span></span><span>
</span><span id="line-452"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">forall {b}. Show b =&gt; ([Fig], b) -&gt; IO ()
</span><a href="#local-6989586621679259635"><span class="hs-identifier hs-var">mkSVG</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[[Fig]]
</span><a href="#local-6989586621679259636"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>  </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;converting to GIF..&quot;</span></span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679259628"><span class="annot"><span class="annottext">opts :: [String]
</span><a href="#local-6989586621679259628"><span class="hs-identifier hs-var hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-delay&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-loop&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;figs/an/*.svg&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259637"><span class="hs-identifier hs-var">fname</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679259627"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259627"><span class="hs-identifier hs-var">hout1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CreateProcess
-&gt; IO (Maybe Handle, Maybe Handle, Maybe Handle, ProcessHandle)
</span><span class="hs-identifier hs-var">createProcess</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; CreateProcess
</span><span class="hs-identifier hs-var">proc</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;convert&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679259628"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">std_out :: StdStream
</span><span class="hs-identifier hs-var">std_out</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdStream
</span><span class="hs-identifier hs-var">CreatePipe</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-456"></span><span>  </span><span id="local-6989586621679259626"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259626"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><span class="hs-identifier hs-var">hGetContents</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259627"><span class="hs-identifier hs-var">hout1</span></a></span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259626"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259637"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-461"></span><span>    </span><span id="local-6989586621679259635"><span class="annot"><span class="annottext">mkSVG :: ([Fig], b) -&gt; IO ()
</span><a href="#local-6989586621679259635"><span class="hs-identifier hs-var hs-var">mkSVG</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259616"><span class="annot"><span class="annottext">[Fig]
</span><a href="#local-6989586621679259616"><span class="hs-identifier hs-var">fr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259615"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679259615"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-462"></span><span>      </span><span id="local-6989586621679259613"><span class="annot"><span class="annottext">si :: String
</span><a href="#local-6989586621679259613"><span class="hs-identifier hs-var hs-var">si</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679259615"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-463"></span><span>      </span><span id="local-6989586621679259607"><span class="annot"><span class="annottext">fnum :: String
</span><a href="#local-6989586621679259607"><span class="hs-identifier hs-var hs-var">fnum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259613"><span class="hs-identifier hs-var">si</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259613"><span class="hs-identifier hs-var">si</span></a></span><span>
</span><span id="line-464"></span><span>      </span><span id="local-6989586621679259599"><span class="annot"><span class="annottext">fname :: String
</span><a href="#local-6989586621679259599"><span class="hs-identifier hs-var hs-var">fname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;figs/an/p&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259607"><span class="hs-identifier hs-var">fnum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.svg&quot;</span></span><span>
</span><span id="line-465"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679259598"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259598"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><span class="hs-identifier hs-var">openFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259599"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span>
</span><span id="line-466"></span><span>            </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Handle -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">hPrint</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259598"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [Fig] -&gt; HtmlT m ()
</span><a href="Algeometry.SVG.html#svg"><span class="hs-identifier hs-var">svg</span></a></span><span> </span><span class="annot"><span class="annottext">[Fig]
</span><a href="#local-6989586621679259616"><span class="hs-identifier hs-var">fr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>            </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679259598"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-468"></span><span>            </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679259599"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">-- | Creates animation from a list of figures.</span><span>
</span><span id="line-471"></span><span id="local-6989586621679260637"><span class="annot"><a href="Algeometry.SVG.html#animateList"><span class="hs-identifier hs-type">animateList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-472"></span><span id="animateList"><span class="annot"><span class="annottext">animateList :: forall a. [Figure PGA2 a] -&gt; Animation ()
</span><a href="Algeometry.SVG.html#animateList"><span class="hs-identifier hs-var hs-var">animateList</span></a></span></span><span> </span><span id="local-6989586621679259596"><span class="annot"><span class="annottext">[Figure PGA2 a]
</span><a href="#local-6989586621679259596"><span class="hs-identifier hs-var">frs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ([[Fig]], a) -&gt; Animation a
</span><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-var">Animation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b. Figure PGA2 b -&gt; [Fig]
</span><a href="Algeometry.SVG.html#figure"><span class="hs-identifier hs-var">figure</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Figure PGA2 a]
</span><a href="#local-6989586621679259596"><span class="hs-identifier hs-var">frs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-comment">-- | Creates animation from a parameterized  function and given nuber of frames.</span><span>
</span><span id="line-475"></span><span id="local-6989586621679260635"><span class="annot"><a href="Algeometry.SVG.html#animate"><span class="hs-identifier hs-type">animate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260635"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-476"></span><span id="animate"><span class="annot"><span class="annottext">animate :: forall a. Int -&gt; XY -&gt; (Double -&gt; Figure PGA2 a) -&gt; Animation ()
</span><a href="Algeometry.SVG.html#animate"><span class="hs-identifier hs-var hs-var">animate</span></a></span></span><span> </span><span id="local-6989586621679259593"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679259593"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679259592"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259592"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679259591"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259591"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679259590"><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679259590"><span class="hs-identifier hs-var">mkFrame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Animation ()
</span><a href="#local-6989586621679259589"><span class="hs-identifier hs-var">frame</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679259588"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-478"></span><span>    </span><span id="local-6989586621679259588"><span class="annot"><span class="annottext">ts :: [Double]
</span><a href="#local-6989586621679259588"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259592"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679259573"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259591"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259592"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679259593"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679259573"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679259573"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679259593"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621679259589"><span class="annot"><span class="annottext">frame :: Double -&gt; Animation ()
</span><a href="#local-6989586621679259589"><span class="hs-identifier hs-var hs-var">frame</span></a></span></span><span> </span><span id="local-6989586621679259572"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259572"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ([[Fig]], a) -&gt; Animation a
</span><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-var">Animation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall b. Figure PGA2 b -&gt; [Fig]
</span><a href="Algeometry.SVG.html#figure"><span class="hs-identifier hs-var">figure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679259590"><span class="hs-identifier hs-var">mkFrame</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259572"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | Creates animation with nonlinear paremeterization.</span><span>
</span><span id="line-483"></span><span id="local-6989586621679260631"><span class="annot"><a href="Algeometry.SVG.html#transform"><span class="hs-identifier hs-type">transform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Figure"><span class="hs-identifier hs-type">Figure</span></a></span><span> </span><span class="annot"><a href="Algeometry.html#PGA2"><span class="hs-identifier hs-type">PGA2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679260631"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algeometry.SVG.html#Animation"><span class="hs-identifier hs-type">Animation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-484"></span><span id="transform"><span class="annot"><span class="annottext">transform :: forall a. Int -&gt; (Double -&gt; Figure PGA2 a) -&gt; Animation ()
</span><a href="Algeometry.SVG.html#transform"><span class="hs-identifier hs-var hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679259571"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679259571"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679259570"><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679259570"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; XY -&gt; (Double -&gt; Figure PGA2 a) -&gt; Animation ()
</span><a href="Algeometry.SVG.html#animate"><span class="hs-identifier hs-var">animate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679259571"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679259569"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-486"></span><span>    </span><span id="local-6989586621679259569"><span class="annot"><span class="annottext">go :: Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679259569"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679259558"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259558"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Figure PGA2 a
</span><a href="#local-6989586621679259570"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">exp</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679259558"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-487"></span></pre></body></html>